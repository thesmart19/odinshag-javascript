var systemParameters={mobileDevice:{isCellPhone:false,isTabletPC:false,isPC:false},user:{isAuth:false}};
if(!Array.prototype.indexOf)Array.prototype.indexOf=function(searchElement,fromIndex){if(this===undefined||this===null)throw new TypeError('"this" is null or not defined');var length=this.length>>>0;fromIndex=+fromIndex||0;if(Math.abs(fromIndex)===Infinity)fromIndex=0;if(fromIndex<0){fromIndex+=length;if(fromIndex<0)fromIndex=0}for(;fromIndex<length;fromIndex++)if(this[fromIndex]===searchElement)return fromIndex;return-1};
if(!String.prototype.trim)String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")};
function resizeImage(width,height,maxImageWidth,maxImageHeight){var marginLeftRight,marginTopBottom,ratio;width=parseInt(width);if(isNaN(width))width=0;height=parseInt(height);if(isNaN(height))height=0;if(width>maxImageWidth||height>maxImageHeight){if(width>maxImageWidth){ratio=width/maxImageWidth;width=maxImageWidth;height=parseInt(height/ratio)}if(height>maxImageHeight){ratio=height/maxImageHeight;width=parseInt(width/ratio);height=maxImageHeight}if(height<maxImageHeight)marginTopBottom=parseInt((maxImageHeight-
height)/2);if(width<maxImageWidth)marginLeftRight=parseInt((maxImageWidth-width)/2);if(isNaN(marginTopBottom))marginTopBottom=0;if(isNaN(marginLeftRight))marginLeftRight=0;return{width:width,height:height,marginTopBottom:marginTopBottom,marginLeftRight:marginLeftRight}}return{width:width,height:height,marginTopBottom:0,marginLeftRight:0}}
function CalculateCityDeliveryRules(updatedTotalPrice){var cityDeliveryRulesPrice=-2;var cityDeliveryRulesNeedToPay=0;if(typeof cityDeliveryRules==="object"){for(var field in cityDeliveryRules)if(updatedTotalPrice>=cityDeliveryRules[field].min&&updatedTotalPrice<=cityDeliveryRules[field].max){cityDeliveryRulesPrice=cityDeliveryRules[field].delivery;if(cityDeliveryRulesPrice==0)cityDeliveryRulesPrice=-1;cityDeliveryRulesNeedToPay=cityDeliveryRules[field].max-updatedTotalPrice}if(updatedTotalPrice>=
cityDeliveryRules[field].max&&cityDeliveryRules[field].delivery==0)cityDeliveryRulesPrice=0}return[cityDeliveryRulesPrice,cityDeliveryRulesNeedToPay]}
function SaveProductToCookies(id,value,residue,price,todelete,source){var fuser=$("input[name=fuser_id]").val();var itemId=$.cookie("new_global_basket_item_"+fuser);var itemNumber=$.cookie("new_global_basket_quant_"+fuser);var itemNumberAlready=$.cookie("shag_global_basket_"+fuser);var itemResidue=residue;var totalPrice=parseInt($("input[name=total_price]").val());var totalNumber=parseInt($("input[name=total_goods]").val());var index=0;var itemSource=source;var itemPrice=price;if(typeof itemSource===
"undefined")itemSource="";if(typeof itemNumberAlready!=="undefined"){itemNumberAlready=itemNumberAlready.split(";");if(typeof itemNumberAlready==="object"){var found=false;var length=itemNumberAlready.length;for(var i=0;i<length;i++){var temp=itemNumberAlready[i].split(":");var tempId=temp[0];var tempNumber=temp[1];var tempSource=temp[2];if(tempId==id){itemNumberAlready=parseInt(tempNumber);found=true;break}}if(!found)itemNumberAlready=0}}else itemNumberAlready=0;if(itemResidue>0){var tcount=0;if(typeof itemNumber!==
"undefined"){var iItemId=JSON.parse(itemId);var iNumber=JSON.parse(itemNumber);var iIndex=iItemId.indexOf(id);if(iIndex>-1)tcount+=iNumber[iIndex]+value}else tcount+=itemNumberAlready+value;if(tcount>itemResidue)return false}if(todelete==true){itemNumberAlready=0;var cardProduct=$(".card-product.in-basket");if(cardProduct.length==1){var cardProductId=cardProduct.find(".actions input").attr("id");cardProductId=parseInt(cardProductId.split("_")[1]);if(isNaN(cardProductId))cardProductId=0;if(cardProductId==
id)cardProduct.removeClass("in-basket")}var itemProduct=$(".item.in-basket");if(itemProduct.length>0)itemProduct.each(function(){var obj=$(this);var productId=obj.find(".add2basket").attr("onclick").split(";")[0];productId=parseInt(productId.split(",")[1]);if(isNaN(productId))productId=0;if(productId==id)obj.removeClass("in-basket")})}var updatedTotalPrice=parseInt($(".header.fixed .wrap .basket a.title span span.name span.price").text());if(isNaN(updatedTotalPrice)||updatedTotalPrice=="")updatedTotalPrice=
0;else if(todelete==true||value<0)updatedTotalPrice-=itemPrice;else if(value>0)updatedTotalPrice+=itemPrice;if(updatedTotalPrice>0&&updatedTotalPrice<500&&$(".main_content").hasClass("allow_order")){$(".main_content").removeClass("allow_order");var cardProduct=$(".card-product.in-basket");if(cardProduct.length==1){var cardProductId=cardProduct.find(".actions input").attr("id");cardProductId=parseInt(cardProductId.split("_")[1]);if(isNaN(cardProductId))cardProductId=0;if(cardProductId==id)$(".number-items").show()}}else if(updatedTotalPrice>=
500&&!$(".main_content").hasClass("allow_order"))$(".main_content").addClass("allow_order");if(typeof itemId==="undefined")itemId=[[id,itemSource]];else itemId=JSON.parse(itemId);if(typeof itemNumber==="undefined"){value+=itemNumberAlready;itemNumber=[value]}else{itemNumber=JSON.parse(itemNumber);index=-1;for(var i in itemId)if(itemId[i][0]==id)index=i;if(index!=-1){if(todelete==true)itemNumber[index]=0;else itemNumber[index]+=value;value=itemNumber[index]}else{value+=itemNumberAlready;itemId.push([id,
itemSource]);itemNumber.push(value)}}itemId=JSON.stringify(itemId);itemNumber=JSON.stringify(itemNumber);totalPrice=JSON.stringify(totalPrice);totalNumber=JSON.stringify(totalNumber);$.cookie("new_global_basket_item_"+fuser,itemId,{expires:30,path:"/"});$.cookie("new_global_basket_quant_"+fuser,itemNumber,{expires:30,path:"/"});$.cookie("new_global_basket_totalprice_"+fuser,totalPrice,{expires:30,path:"/"});$.cookie("new_global_basket_totalgoods_"+fuser,totalNumber,{expires:30,path:"/"});return JSON.stringify([id,
value,itemNumberAlready,totalPrice,totalNumber])}var hideBasketTimer,hideBasketTimerValue=5E3;
function put2cart(object,id,source){var object=$(object);var productId=id;var productCount=0;var productPrice=0;var productName;var productImage,productImageWidth,productImageHeight,productImageMaxHeight=90,productImageMaxWidth=90;var productImageMarginLeftRight=0,productImageMarginTopBottom=0;var productResidue;var productSource=source;var isProductInList=false;var isDeliveryFree=false;var productInBasket=false;if(object.parent().parent().hasClass("parameters")||object.parent().hasClass("parameters")&&
object.parent().parent().hasClass("item"))isProductInList=true;productResidue=parseInt(object.parent().parent().find(".residue span#"+productId+"_sale_count").text());if(productResidue==0||isNaN(productResidue))productResidue=parseInt(object.parent().parent().find("input#"+productId+"_sale_count").val());if(isNaN(productResidue))productResidue=0;productCount=parseInt(object.parent().find("#count_"+productId).val());if(isNaN(productCount))productCount=1;productPrice=parseInt(object.parent().find(".price span i").text());
if(isNaN(productPrice))productPrice=0;if(isProductInList)productPrice=parseInt(object.parent().find(".price span.actual").text());if(productPrice==0||isNaN(productPrice))productPrice=parseInt(object.parent().parent().find(".price span.actual").text());if(isNaN(productPrice))productPrice=0;productName=$("h1").text();if(isProductInList)productName=object.parent().parent().find(".name a").text();if(typeof productName=="undefined")productName="";var image=$(".card-product-image .photo-slider ul li.active a img");
if(isProductInList)if(object.parent().hasClass("parameters")&&object.parent().parent().hasClass("item"))image=object.parent().parent().find("a.img img");else image=object.parent().parent().parent().find("a.img img");productImage=image.attr("src");productImageWidth=image.attr("width");productImageHeight=image.attr("height");var dimentions=resizeImage(productImageWidth,productImageHeight,productImageMaxWidth,productImageMaxHeight);productImageWidth=dimentions.width;productImageHeight=dimentions.height;
productImageMarginLeftRight=dimentions.marginLeftRight;productImageMarginTopBottom=dimentions.marginTopBottom;isDeliveryFree=object.parent().parent().parent().parent().find(".card-product-image .photo-slider .delivery").text();if(typeof isDeliveryFree!=="undefined"&&isDeliveryFree!="")isDeliveryFree=true;else{isDeliveryFree=object.parent().parent().find("span.delivery").text();if(typeof isDeliveryFree!=="undefined"&&isDeliveryFree!="")isDeliveryFree=true;else{isDeliveryFree=object.parent().parent().find("a.img .labels .free-shipping").attr("title");
if(typeof isDeliveryFree!=="undefined")isDeliveryFree=true}}productInBasket=SaveProductToCookies(productId,productCount,productResidue,productPrice,false,productSource);if(productInBasket!=false){productInBasket=JSON.parse(productInBasket);var addedProductId=parseInt(productInBasket[0]);var addedProductNumber=parseInt(productInBasket[1]);var addedProductAlready=parseInt(productInBasket[2]);var addedTotalPrice=parseInt(productInBasket[3]);var addedTotalNumber=parseInt(productInBasket[4]);$(".header.fixed .wrap .basket .message.product-preview").remove();
var ulItems=$(".header.fixed .wrap .basket .message ul.items");var updatedTotalPrice=$(".header.fixed .wrap .basket a.title span span.name span.price").text();updatedTotalPrice=parseInt(updatedTotalPrice);if(isNaN(updatedTotalPrice))updatedTotalPrice=0;updatedTotalPrice+=productPrice*productCount;var updatedTotalCount=$(".header.fixed .wrap .basket a.title span span.name span.count").text();updatedTotalCount=parseInt(updatedTotalCount);if(isNaN(updatedTotalCount))updatedTotalCount=0;updatedTotalCount+=
productCount;var cityDeliveryRulesPrice=-2;var cityDeliveryRulesNeedToPay=0;var temp=CalculateCityDeliveryRules(updatedTotalPrice);cityDeliveryRulesPrice=temp[0];cityDeliveryRulesNeedToPay=temp[1];if(isDeliveryFree===true||cityDeliveryRulesPrice==0){$(".header.fixed .wrap .basket a.title span span.name").html('<span class="price">'+updatedTotalPrice+'</span> \u0440. (<span class="count">'+updatedTotalCount+"</span> \u0448\u0442.)");if($(".header.fixed .wrap .basket a.title span span.delivery").attr("class")!=
"delivery"){$(".header.fixed .wrap .basket a.title span:not(.name, .name .price, .name .count, .icon)").append("<span class='delivery'>\u0411\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u0430\u044f \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0430</span>");$(".header.fixed .wrap .basket a.title span span.icon").addClass("free")}}else{var declension="";switch(updatedTotalCount%10){case 2:case 3:case 4:declension="\u0430";break;case 5:case 6:case 7:case 8:case 9:case 0:declension="\u043e\u0432";break}$(".header.fixed .wrap .basket a.title span span.name").html('\u0412 \u043a\u043e\u0440\u0437\u0438\u043d\u0435 <span class="count">'+
updatedTotalCount+"</span> \u0442\u043e\u0432\u0430\u0440"+declension+' \u043d\u0430 \u0441\u0443\u043c\u043c\u0443 <span class="price">'+updatedTotalPrice+"</span> \u0440.")}if(updatedTotalPrice>=500)$(".header.fixed .wrap .basket").removeClass("not-available");else $(".header.fixed .wrap .basket").addClass("not-available");ulItems.find("li.item .parameters .counter input[name='product_"+productId+"']").val(addedProductNumber);var productPreview="";productPreview+='<li class="item';if(isDeliveryFree===
true)productPreview+=" free_delivery";productPreview+='">';productPreview+='<a class="img" href="#" title="'+productName+'">';productPreview+='<span class="helper">&nbsp;</span>';productPreview+='<img src="'+productImage+'" width="'+productImageWidth+'" height="'+productImageHeight+'" alt="'+productName+'">';productPreview+="</a>";productPreview+='<div class="parameters">';productPreview+='<div class="name">';productPreview+='<a href="#" title="'+productName+'">'+productName+"</a>";productPreview+=
"</div>";productPreview+='<div class="counter">';productPreview+='<a class="minus" href="#" title="-">-</a>';productPreview+='<input type="text" name="product_'+productId+'" value="'+addedProductNumber+'">';productPreview+='<a class="plus" href="#" title="+">+</a>';productPreview+="</div>";productPreview+='<div class="price">'+productPrice+" \u0440.</div>";productPreview+='\x3c!--<div class="article">\u0410\u0440\u0442\u0438\u043a\u0443\u043b: <span>771-640-999</span></div>--\x3e';productPreview+=
"</div>";productPreview+='<a class="delete" href="#" title="\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0442\u043e\u0432\u0430\u0440 \u0438\u0437 \u043a\u043e\u0440\u0437\u0438\u043d\u044b">&nbsp;</a>';if(productResidue>0)productPreview+='<input type="hidden" name="residue" value="'+productResidue+'">';productPreview+="</li>";if($(".header.fixed .wrap .basket .message").length==0){var message='<div class="message">';message+='<span class="arrow">&nbsp;</span>';message+='<ul class="items odinshag-skin" style="height:96px;">';
message+=productPreview;message+="</ul>";message+='<div class="total">';message+='<div class="info-message blue"';if((cityDeliveryRulesPrice==-1||cityDeliveryRulesPrice>0)&&cityDeliveryRulesNeedToPay>0)message+=' style="display: block;"';message+=">";message+='<span class="icon">&nbsp;</span>';message+='<p class="text">';message+="\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0435\u0449\u0435 \u043d\u0430 <b>"+cityDeliveryRulesNeedToPay+" \u0440</b> ";
if(cityDeliveryRulesPrice==-1)message+="\u0438 \u0432\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043c\u044b \u0434\u043e\u0441\u0442\u0430\u0432\u0438\u043c \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e.";else if(cityDeliveryRulesPrice>0)message+="\u0438 \u043c\u044b \u0434\u043e\u0441\u0442\u0430\u0432\u0438\u043c \u0437\u0430\u043a\u0430\u0437 \u0432\u0441\u0435\u0433\u043e \u0437\u0430 "+cityDeliveryRulesPrice+"\u0440.";message+="</p>";message+="</div>";if(updatedTotalPrice>=500)message+=
'<a class="button green" href="/personal/buy/order.php" title="\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443 \u0434\u043b\u044f \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430">\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437</a>';else message+='<span class="text">\u0421\u0443\u043c\u043c\u0430 \u0437\u0430\u043a\u0430\u0437\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u0435\u0435 500 \u0440.</span>';
message+="</div>";message+='<div class="border">&nbsp;</div>';message+="</div>";$(".header.fixed .wrap .basket").append('<div class="fixed-wrap">&nbsp;</div>');$(".header.fixed .wrap .basket").append(message)}else{var temp=ulItems.find("input[name='product_"+productId+"']");if(typeof temp.val()!=="undefined")temp.val(addedProductNumber);else if(ulItems.find(".viewport .overview").length>0)ulItems.find(".viewport .overview").append(productPreview);else ulItems.append(productPreview);var length=ulItems.find("li").length;
if(length>3)ulItems.find("li").css({"width":"318px"});else{ulItems.find("li").css({"width":"333px"});switch(length){case 1:ulItems.css({"height":"96px"});break;case 2:ulItems.css({"height":"193px"});break;case 3:ulItems.css({"height":"290px"});break}}ulItems.customScrollbar("resize",true);var totalContent="";totalContent+='<div class="info-message blue"';if((cityDeliveryRulesPrice==-1||cityDeliveryRulesPrice>0)&&cityDeliveryRulesNeedToPay>0)totalContent+=' style="display: block;"';totalContent+=">";
totalContent+='<span class="icon">&nbsp;</span>';totalContent+='<p class="text">';totalContent+="\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0435\u0449\u0435 \u043d\u0430 <b>"+cityDeliveryRulesNeedToPay+" \u0440</b> ";if(cityDeliveryRulesPrice==-1)totalContent+="\u0438 \u0432\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043c\u044b \u0434\u043e\u0441\u0442\u0430\u0432\u0438\u043c \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e.";else if(cityDeliveryRulesPrice>
0)totalContent+="\u0438 \u043c\u044b \u0434\u043e\u0441\u0442\u0430\u0432\u0438\u043c \u0437\u0430\u043a\u0430\u0437 \u0432\u0441\u0435\u0433\u043e \u0437\u0430 "+cityDeliveryRulesPrice+"\u0440.";totalContent+="</p>";totalContent+="</div>";if(updatedTotalPrice>=500){$(".header.fixed .wrap .basket .message .total span.text").remove();totalContent+='<a class="button green" href="/personal/buy/order.php" title="\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443 \u0434\u043b\u044f \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430">\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437</a>';
$(".header.fixed .wrap .basket .message .total").html(totalContent)}else{$(".header.fixed .wrap .basket .message .total a.button").remove();totalContent+='<span class="text">\u0421\u0443\u043c\u043c\u0430 \u0437\u0430\u043a\u0430\u0437\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u0435\u0435 500 \u0440.</span>';$(".header.fixed .wrap .basket .message .total").html(totalContent)}}message='<div class="message product-preview">';message+='<span class="arrow">&nbsp;</span>';
message+='<ul class="items odinshag-skin" style="height:96px;">';message+=productPreview;message+="</ul>";message+='<div class="total">';message+='<div class="info-message blue"';if((cityDeliveryRulesPrice==-1||cityDeliveryRulesPrice>0)&&cityDeliveryRulesNeedToPay>0)message+=' style="display: block;"';message+=">";message+='<span class="icon">&nbsp;</span>';message+='<p class="text">';message+="\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0435\u0449\u0435 \u043d\u0430 <b>"+
cityDeliveryRulesNeedToPay+" \u0440</b> ";if(cityDeliveryRulesPrice==-1)message+="\u0438 \u0432\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043c\u044b \u0434\u043e\u0441\u0442\u0430\u0432\u0438\u043c \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e.";else if(cityDeliveryRulesPrice>0)message+="\u0438 \u043c\u044b \u0434\u043e\u0441\u0442\u0430\u0432\u0438\u043c \u0437\u0430\u043a\u0430\u0437 \u0432\u0441\u0435\u0433\u043e \u0437\u0430 "+cityDeliveryRulesPrice+"\u0440.";message+="</p>";message+=
"</div>";if(updatedTotalPrice>=500)message+='<a class="button green" href="/personal/buy/order.php" title="\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443 \u0434\u043b\u044f \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430">\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437</a>';else message+='<span class="text">\u0421\u0443\u043c\u043c\u0430 \u0437\u0430\u043a\u0430\u0437\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u0435\u0435 500 \u0440.</span>';
message+="</div>";message+='<div class="border">&nbsp;</div>';message+="</div>";$(".header.fixed .wrap .basket").append(message);$(".header.fixed .wrap .basket").addClass("active");$(".header.fixed .wrap .basket .message").hide();$(".header.fixed .wrap .basket .message.product-preview").show();clearTimeout(hideBasketTimer);hideBasketTimer=setTimeout(function(){$(".header.fixed .wrap .basket .message.product-preview").remove()},hideBasketTimerValue);if(object.hasClass("add2basket")){if(updatedTotalPrice>=
500){$(".main_content").addClass("allow_order");if(productSource=="Card")object.parent().children(".number-items").hide()}switch(productSource){case "Card":$(".card-product").addClass("in-basket");break;case "SimilarItems":case "CardCrossSale":case "Preview":object.parent().parent().parent().addClass("in-basket");break;default:object.parent().parent().parent().addClass("in-basket");break}}if(typeof yaCounter10648792!=="undefined")yaCounter10648792.reachGoal("ADD_TO_CART");if(!systemParameters.mobileDevice.isCellPhone){$("body").append("<img src='//pixel.ritorno.ru/pixel?pid=4957&oid="+
productId+"&basket_action=add&sid=118' width='1' height='1' alt=''>");if(typeof rrApi!=="undefined")try{rrApi.addToBasket(productId)}catch(e){}}}else{var tooltip=$(".header.fixed .wrap .basket .tooltip");tooltip.html("<span class='arrow'>&nbsp;</span>\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043d\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u0430!");tooltip.show();clearTimeout(hideBasketTimer);
hideBasketTimer=setTimeout(function(){tooltip.hide()},hideBasketTimerValue)}return false}function showAnswerForm(commentID,object){$(object).parent().find(".answer-form").show();return false}var productAddToLimit=99;
function AddToFavorites(obj,subdivisionID,productID){var object=$(obj);var favorites=$(".header.fixed .wrap .favorites");if(!object.hasClass("active")){var response=AddToCookies("favorites",subdivisionID,productID,productAddToLimit);if(response=="Product added"||response=="Product exists"){object.addClass("active");object.find("span:not(.icon)").text("\u041f\u0435\u0440\u0435\u0439\u0442\u0438");var count=parseInt(favorites.find(".count").text())+1;if(isNaN(count))count=1;favorites.find(".count").text(count);
if(!favorites.hasClass("active"))favorites.addClass("active");if(!favorites.find(".count").hasClass("color"))favorites.find(".count").addClass("color");favorites.find(".message").html("<span class='arrow'>&nbsp;</span>"+systemMessages.info.productAdded2Favorites);favorites.find(".message").show();if(typeof yaCounter10648792!=="undefined")yaCounter10648792.reachGoal("ADD_2_FAVORITES");clearTimeout(hideBasketTimer);hideBasketTimer=setTimeout(function(){favorites.find(".message").hide();$(".header.fixed .wrap .compare .message").hide()},
hideBasketTimerValue)}else if(response=="Limit is exceeded"){object.removeClass("active");object.find("span:not(.icon)").text("\u0412 \u0438\u0437\u0431\u0440\u0430\u043d\u043d\u043e\u0435");favorites.find(".message").html("<span class='arrow'>&nbsp;</span>"+systemMessages.error.limitExceeted);favorites.find(".message").show();clearTimeout(hideBasketTimer);hideBasketTimer=setTimeout(function(){favorites.find(".message").hide();$(".header.fixed .wrap .compare .message").hide()},hideBasketTimerValue)}}else document.location.href=
"/personal/favorites/"}
function DeleteFromFavorites(obj,subdivisionID,productID){if(typeof subdivisionID!=="undefined"&&typeof productID!=="undefined"){var object=$(obj);if(object.parent().parent().hasClass("item")&&object.hasClass("icon")){span=$(".header.fixed .wrap .favorites span.count");count=parseInt(span.text())-1;if(isNaN(count)||count<0)count=0;span.text(count);var span=$(".categories.compare_sections").find("li.active span span");var count=parseInt(span.text())-1;if(isNaN(count)||count<0)count=0;span.text(count);
object.parent().parent().remove()}DeleteFromCookies("","favorites",subdivisionID,productID)}else if(typeof subdivisionID!=="undefined"){DeleteFromCookies("","favorites",subdivisionID);window.location.reload(true)}return}function ClearFavorites(message){DeleteFromCookies(message,"favorites")}function AddToViewed(subdivisionID,productID){var response=AddToCookies("viewed",subdivisionID,productID,productAddToLimit)}
function DeleteFromViewed(obj,subdivisionID,productID){if(typeof subdivisionID!=="undefined"&&typeof productID!=="undefined"){var object=$(obj);if(object.parent().parent().hasClass("item")){var span=$(".categories.compare_sections").find("li.active span span");var count=parseInt(span.text())-1;if(isNaN(count)||count<0)count=0;span.text(count);span=$(".header.fixed .wrap .viewed span.count");count=parseInt(span.text())-1;if(isNaN(count)||count<0){count=0;$(".header.fixed .wrap .viewed span.count").removeClass("color")}span.text(count);
object.parent().parent().remove()}DeleteFromCookies("","viewed",subdivisionID,productID)}else if(typeof subdivisionID!=="undefined"){DeleteFromCookies("","viewed",subdivisionID);window.location.reload(true)}return}function ClearViewed(message){DeleteFromCookies(message,"viewed")}
function AddToCompared(obj,subdivisionID,productID){var object=$(obj);var compared=$(".header.fixed .wrap .compare");if(!object.hasClass("active")){var response=AddToCookies("compared",subdivisionID,productID,productAddToLimit);if(response=="Product added"||response=="Product exists"){object.addClass("active");object.find("span:not(.icon)").text("\u041f\u0435\u0440\u0435\u0439\u0442\u0438");var count=parseInt(compared.find(".count").text())+1;if(isNaN(count))count=1;compared.find(".count").text(count);
if(!compared.hasClass("active"))compared.addClass("active");if(!compared.find(".count").hasClass("color"))compared.find(".count").addClass("color");compared.find(".message").html("<span class='arrow'>&nbsp;</span>"+systemMessages.info.productAdded2Compare);compared.find(".message").show();if(typeof yaCounter10648792!=="undefined")yaCounter10648792.reachGoal("ADD_2_COMPARE");clearTimeout(hideBasketTimer);hideBasketTimer=setTimeout(function(){compared.find(".message").hide();$(".header.fixed .wrap .favorites .message").hide()},
hideBasketTimerValue)}else if(response=="Limit is exceeded"){object.removeClass("active");object.find("span:not(.icon)").text("\u0421\u0440\u0430\u0432\u043d\u0438\u0442\u044c");compared.find(".message").html("<span class='arrow'>&nbsp;</span>"+systemMessages.error.limitExceeted);compared.find(".message").show();clearTimeout(hideBasketTimer);hideBasketTimer=setTimeout(function(){compared.find(".message").hide();$(".header.fixed .wrap .favorites .message").hide()},hideBasketTimerValue)}}else document.location.href=
"/personal/compare/";return}
function DeleteFromCompared(obj,subdivisionID,productID){if(typeof subdivisionID!=="undefined"&&typeof productID!=="undefined"){var object=$(obj);if(object.parent().parent().hasClass("item")&&object.hasClass("icon")){var span=$(".categories.compare_sections").find("li.active span span");var count=parseInt(span.text())-1;if(isNaN(count)||count<0)count=0;span.text(count);span=$(".header.fixed .wrap .compare span.count");count=parseInt(span.text())-1;if(isNaN(count)||count<0)count=0;span.text(count);
object.parent().parent().remove();var productListHeight=$(".product-list.vertical").css("height");$(".product-list.vertical").customScrollbar("resize",true);if($(".product-list.vertical").find("li").length>=3){productListHeight=parseInt(productListHeight)-15;setTimeout(function(){$(".product-list.vertical .viewport").css({"height":productListHeight})},5)}}DeleteFromCookies("","compared",subdivisionID,productID)}else if(typeof subdivisionID!=="undefined"){DeleteFromCookies("","compared",subdivisionID);
window.location.reload(true)}return}function ClearCompared(message){DeleteFromCookies(message,"compared")}
function AddToCookies(cookieName,subdivisionID,productID,limit){var cookie=$.cookie(cookieName);var productLimit=0;if(typeof limit!=="undefined")productLimit=limit;if(typeof cookie==="undefined"){cookie={};cookie.count=1;cookie.items={};cookie.items[subdivisionID]=[productID];cookie=JSON.stringify(cookie);if(systemParameters.user.isAuth)$.cookie(cookieName,cookie,{expires:30,path:"/"});else $.cookie(cookieName,cookie,{expires:"",path:"/"});return"Product added"}else{cookie=JSON.parse(cookie);if(typeof cookie===
"object"){var count=0;for(var field in cookie){if(field=="count"){count=cookie[field];if(typeof count==="undefined")count=0;count++}if(field=="items"){var hasSubdivision=false;var queueLimit=3;for(var subID in cookie[field])if(subID==subdivisionID){hasSubdivision=true;var c=cookie[field][subdivisionID].length;var isAdded=false;for(var i=0;i<c;i++)if(cookie[field][subdivisionID][i]==productID)isAdded=true;if(!isAdded){if(productLimit>0){if(count>productLimit){count=productLimit;for(var i=0;i<cookie[field][subdivisionID].length;i++)if(cookie[field][subdivisionID][i]!=
null){cookie[field][subdivisionID][i]=null;break}}cookie["count"]=count;cookie[field][subdivisionID].push(productID)}}else return"Product exists"}if(!hasSubdivision)if(productLimit>0){if(count>productLimit){count=productLimit;if(field=="items")for(var subID in cookie[field])if(subID!=0){for(var i=0;i<cookie[field][subID].length;i++)if(cookie[field][subID][i]!=null){cookie[field][subID][i]=null;delete cookie[field][subID][i];break}break}}cookie["count"]=count;cookie[field][subdivisionID]=[productID]}}}cookie=
JSON.stringify(cookie);if(systemParameters.user.isAuth)$.cookie(cookieName,cookie,{expires:30,path:"/"});else $.cookie(cookieName,cookie,{expires:"",path:"/"});return"Product added"}}}
function DeleteFromCookies(message,cookieName,subdivisionID,productID){var cookie=$.cookie(cookieName);if(typeof cookie!=="undefined"){cookie=JSON.parse(cookie);if(typeof cookie==="object"){var count=0;if(typeof subdivisionID!=="undefined"&&typeof productID!=="undefined")for(var field in cookie){if(field=="count"){count=cookie[field];if(typeof count==="undefined")count=1;count--}if(field=="items")for(var subID in cookie[field])if(subID==subdivisionID){var c=cookie[field][subdivisionID].length;for(var i=
0;i<c;i++)if(cookie[field][subdivisionID][i]==productID){cookie["count"]=count;delete cookie[field][subdivisionID][i];count=0;for(var i=0;i<cookie[field][subdivisionID].length;i++)if(cookie[field][subdivisionID][i]!=null)count++;if(count==0){DeleteFromCookies("",cookieName,subdivisionID);if(window.location.href.indexOf("catalog")==-1&&window.location.href.indexOf("product")==-1)window.location.reload(true)}}}}else if(typeof subdivisionID!=="undefined")for(var field in cookie){if(field=="items")for(var subID in cookie[field])if(subID==
subdivisionID){var c=cookie[field][subdivisionID].length;for(var i=0;i<c;i++)if(cookie[field][subdivisionID][i]!=null)count++;cookie["count"]-=count;if(cookie["count"]<0)cookie["count"]=0;delete cookie[field][subdivisionID]}}else if(typeof subdivisionID==="undefined"&&typeof productID==="undefined"){cookie.count=0;cookie.items={};switch(cookieName){case "favorites":$(".header.fixed .wrap .favorites").removeClass("active");$(".header.fixed .wrap .favorites a.title span .name .count").text("0");$(".box .content").html(GetInfoMessageHtml(message));
break;case "viewed":$(".header.fixed .wrap .viewed").removeClass("active");$(".header.fixed .wrap .viewed a.title span .name .count").text("0");$(".box .content").html(GetInfoMessageHtml(message));break;case "compared":$(".header.fixed .wrap .compare").removeClass("active");$(".header.fixed .wrap .compare a.title span .name .count").text("0");$(".box .content").html(GetInfoMessageHtml(message));break}}cookie=JSON.stringify(cookie);if(systemParameters.user.isAuth)$.cookie(cookieName,cookie,{expires:30,
path:"/"});else $.cookie(cookieName,cookie,{expires:"",path:"/"})}}}function GetInfoMessageHtml(text){return GetMessageHtml(text,"blue")}function GetErrorMessageHtml(text){return GetMessageHtml(text,"red")}function GetCommonMessageHtml(text){return GetMessageHtml(text,"black no-border no-icon")}function GetCommonErrorMessageHtml(text){return GetMessageHtml(text,"red no-border no-icon")}
function GetMessageHtml(text,className){return"<div class='info-message "+className+"'>"+"<span class='icon'>&nbsp;</span>"+"<p class='text'>"+text+"</p>"+"</div>"}
$(document).ready(function(){(function($){$.fn.productCounter=function(){var object=$(this);var maxProductCount;maxProductCount=parseInt($(".residue span").text());if(isNaN(maxProductCount))maxProductCount=999;var productCount=parseInt(object.find("ul li input").val());if(isNaN(productCount)){productCount=1;object.find("ul li input").val(productCount)}object.find("ul li.minus, ul li.item-minus").click(function(){var input=$(this).parent().find("li input");var value=parseInt(input.val());productCount=
value-1;if(isNaN(productCount)||productCount<1){productCount=1;input.val(productCount)}else input.val(productCount);return false});object.find("ul li.plus, ul li.item-plus").click(function(){var input=$(this).parent().find("li input");var value=parseInt(input.val());productCount=value+1;if(isNaN(productCount)){productCount=0;input.val(productCount)}else{if(productCount>maxProductCount)productCount=maxProductCount;input.val(productCount)}return false});object.find("ul li input").focus(function(){var input=
$(this);var value=parseInt(input.val());if(isNaN(value))input.val(productCount);else productCount=value});object.find("ul li input").blur(function(){var input=$(this);var value=parseInt(input.val());if(isNaN(value)||value<0)input.val(productCount);else{productCount=value;if(productCount>maxProductCount)productCount=maxProductCount;input.val(productCount)}})}})(jQuery);(function($){$.fn.photoSlider=function(slideDuration,scrollDuration){var object=$(this);var wrap=object.find(".wrap");var mainImage=
object.find(".items");var mainImageCount=mainImage.find("li").length;var thumbnails=object.find(".thumbnails");var thumbnailsCount=thumbnails.find("li").length;var prevImage=object.find(".prev");var nextImage=object.find(".next");var prevArrow=object.find(".prev-arrow");var nextArrow=object.find(".next-arrow");var activeImageIndex=0;var maxImageWidth=500;var maxImageHeight=380;var zoomImageHeight=mainImage.find("li a").height();var container=object.find(".container");var isSliding=false;var timer,
initTimer;var delivery=mainImage.find(".delivery");if(wrap.length==0){mainImage.find("li a img").one("load",function(){var li=$(this).parent().parent();if(!li.hasClass("active")){li.addClass("active");li.removeClass("active")}if(jQuery.isFunction(li.find("a.zoom").zoom)){var sourceImg=li.find("img:not(.zoomImg)");if(sourceImg.attr("src")=="/images/cosmo/no_photo.png"){li.find("a.zoom").css({"cursor":"default"});li.find("a.zoom .lens").css({"display":"none"})}else li.find("a.zoom").zoom({on:"mouseover",
touch:true,duration:250,onZoomIn:function(){sourceImg.css({"display":"none"})},onZoomOut:function(){sourceImg.css({"display":"inline-block"})}})}}).each(function(){if(this.complete)$(this).load()});mainImage.find("li a.zoom").click(function(event){event.preventDefault()});if(mainImageCount!=thumbnailsCount)return false;thumbnails.find("li").click(function(){hideImages();activeImageIndex=$(this).index();showImages();return false});prevImage.hover(function(){prevArrow.addClass("hover")},function(){prevArrow.removeClass("hover")});
prevImage.click(function(){hideImages();activeImageIndex--;if(activeImageIndex<0)activeImageIndex=mainImageCount-1;showImages();return false});prevArrow.click(function(){hideImages();activeImageIndex--;if(activeImageIndex<0)activeImageIndex=mainImageCount-1;showImages();return false});nextImage.hover(function(){nextArrow.addClass("hover")},function(){nextArrow.removeClass("hover")});nextImage.click(function(){hideImages();activeImageIndex++;if(activeImageIndex>=mainImageCount)activeImageIndex=0;showImages();
return false});nextArrow.click(function(){hideImages();activeImageIndex++;if(activeImageIndex>=mainImageCount)activeImageIndex=0;showImages();return false});function hideImages(){thumbnails.find("li div").removeClass("active");mainImage.find("li").removeClass("active")}function showImages(){thumbnails.find("li").each(function(i){if(i==activeImageIndex){var div=$(this).find("div");if(div.hasClass("hover"))div.removeClass("hover");div.addClass("active")}});mainImage.find("li").each(function(i){if(i==
activeImageIndex){$(this).addClass("active");if($(this).hasClass("video"))delivery.hide();else delivery.show()}})}}else{mainImage=object.find(".wrap .items");mainImageCount=mainImage.find("li").length;thumbnails=object.find(".thumbnails");thumbnailsCount=thumbnails.find("li:not(.all)").length;var maxImageWidth=0;var maxImageHeight=0;if(mainImageCount!=thumbnailsCount)return false;var slideFirst=$(mainImage.find("li")[0]).html();mainImage.append("<li>"+slideFirst+"</li>");var slideLast=$(mainImage.find("li")[mainImageCount-
1]).html();mainImage.prepend("<li>"+slideLast+"</li>");$(mainImage.find("li")[1]).addClass("active");$(thumbnails.find("li")[0]).addClass("active");activeImageIndex=0;$(window).resize(function(){clearTimeout(initTimer);initTimer=setTimeout(function(){if(object.find(".wrap").width()==741||object.find(".wrap").width()==758)mainImage.find("li a img").each(function(index){if(index==0){maxImageWidth=$(this).width();maxImageHeight=$(this).height();activeImageIndex=0;mainImage.css({"width":mainImageCount*
maxImageWidth});mainImage.css({"left":maxImageWidth*-1});mainImage.find("li").removeClass("active");$(mainImage.find("li")[activeImageIndex]).addClass("active");thumbnails.find("li").removeClass("active");$(thumbnails.find("li:not(.all)")[activeImageIndex]).addClass("active")}})},250)});var index=0;mainImage.find("li a img").one("load",function(){index++;if(index==mainImageCount){maxImageWidth=$(this).width();maxImageHeight=$(this).height();mainImage.css({"width":mainImageCount*maxImageWidth});mainImage.css({"left":maxImageWidth*
-1});timer=setInterval(function(){if(!isSliding)SlideTo(0)},slideDuration)}}).each(function(){if(this.complete)$(this).load()});thumbnails.find("li:not(.all) a").click(function(event){var obj=$(this);var li=obj.parent();activeImageIndex=li.index();mainImage.find("li").removeClass("active");$(mainImage.find("li")[activeImageIndex]).addClass("active");thumbnails.find("li").removeClass("active");li.addClass("active");MoveTo(activeImageIndex);event.preventDefault()});prevImage.click(function(event){if(!isSliding)SlideTo(1);
event.preventDefault()});nextImage.click(function(event){if(!isSliding)SlideTo(0);event.preventDefault()});object.mouseover(function(event){clearInterval(timer)});object.mouseleave(function(event){timer=setInterval(function(){if(!isSliding)SlideTo(0)},slideDuration)});function SlideTo(direction){var mainImageLeft=parseInt(mainImage.css("left"));if(isNaN(mainImageLeft))mainImageLeft=0;if(direction==0){mainImageLeft-=maxImageWidth;isSliding=true;mainImage.animate({left:mainImageLeft},scrollDuration,
function(){activeImageIndex++;if(activeImageIndex>=mainImageCount)activeImageIndex=0;mainImage.find("li").removeClass("active");$(mainImage.find("li")[activeImageIndex]).addClass("active");thumbnails.find("li").removeClass("active");$(thumbnails.find("li:not(.all)")[activeImageIndex]).addClass("active");if(mainImageLeft==(mainImageCount+1)*maxImageWidth*-1)mainImage.css({"left":maxImageWidth*-1});isSliding=false})}if(direction==1){mainImageLeft+=maxImageWidth;isSliding=true;mainImage.animate({left:mainImageLeft},
scrollDuration,function(){activeImageIndex--;if(activeImageIndex<0)activeImageIndex=mainImageCount-1;mainImage.find("li").removeClass("active");$(mainImage.find("li")[activeImageIndex]).addClass("active");thumbnails.find("li").removeClass("active");$(thumbnails.find("li:not(.all)")[activeImageIndex]).addClass("active");if(mainImageLeft==0)mainImage.css({"left":mainImageCount*maxImageWidth*-1});isSliding=false})}}function MoveTo(index,duration){mainImageLeft=(index+1)*maxImageWidth*-1;if(typeof duration==
"undefined"||duration==0)mainImage.css({"left":mainImageLeft});else{isSliding=true;mainImage.animate({left:mainImageLeft},duration,function(){mainImage.find("li").removeClass("active");$(mainImage.find("li")[activeImageIndex]).addClass("active");thumbnails.find("li").removeClass("active");$(thumbnails.find("li:not(.all)")[activeImageIndex]).addClass("active");isSliding=false})}}}}})(jQuery);var showCatalogTimer;$(".menu-category_new").click(function(){var object=$(this);var menu=object.parent().find(".product-card-menu");
if(menu.css("display")=="none")menu.css({"display":"block"});else menu.css({"display":"none"})});$(".product-card-menu").mouseover(function(){clearTimeout(showCatalogTimer)});$(".product-card-menu").mouseleave(function(){showCatalogTimer=setTimeout(function(){$(".product-card-menu").hide()},500)});(function($){$.fn.productListManagement=function(){var object=$(this);var pages=object.find(".pages");var dropDownList=object.find(".drop-down-list");var dropDownListHeight=0;var dropDownListMinHeight=27;
var dropDownListOpen=false;var viewModes=object.find(".view-modes a");var productList=object.parent().find(".product-list:not(.collective-buying)");var productListWidth=parseInt(productList.width());var productItem=productList.find("li.item");var productItemWidth=parseInt(productItem.width());var select=object.find("select");viewModes.click(function(event){var object=$(this);viewModes.removeClass("active");if(object.hasClass("vertical")){object.parent().parent().parent().find(".pager .view-modes .vertical").addClass("active");
$(".product-list").removeClass("horizontal");$(".product-list").addClass("vertical");$.cookie("os_catalog_view",0,{expires:"",path:"/"})}else if(object.hasClass("horizontal")){object.parent().parent().parent().find(".pager .view-modes .horizontal").addClass("active");$(".product-list").removeClass("vertical");$(".product-list").addClass("horizontal");$.cookie("os_catalog_view",1,{expires:"",path:"/"})}event.preventDefault()});dropDownListHeight=dropDownList.find(".options").height();dropDownList.find(".options").css({"height":dropDownListMinHeight+
"px"});dropDownList.find(".options .icon, .options a.selected").click(function(event){var object=$(this);var options=object.parent();if(!dropDownListOpen)options.animate({height:dropDownListHeight},500,function(){dropDownListOpen=true});else options.animate({height:dropDownListMinHeight},500,function(){dropDownListOpen=false});event.preventDefault()});productItem.on("mouseover",function(){$(this).addClass("hover");$(this).find(".button").addClass("pre-hover")});productItem.on("mouseout",function(){$(this).removeClass("hover");
$(this).find(".button").removeClass("pre-hover")});productItem.find(".button").on("mouseover",function(){$(this).addClass("hover")});productItem.find(".button").on("mouseout",function(){$(this).removeClass("hover")});select.change(function(){var sid=parseInt($(this).find("option:selected").val());if(!isNaN(sid)&&sid>0)window.location.search="?sid="+sid})}})(jQuery);(function($){$.fn.tabsSwitch=function(number){if(typeof number==="undefined")number=0;var object=$(this);var titles=object.children(".titles").children("a");
var pages=object.children(".pages").children(".page");pages.hide();pages.each(function(pageIndex){if(pageIndex==number){$(this).show();return true}});titles.click(function(event){if(!$(this).hasClass("active")){titles.removeClass("active");$(this).addClass("active");pages.hide();var tabIndex=$(this).index();pages.each(function(pageIndex){if(tabIndex==pageIndex)$(this).show()})}event.preventDefault()})}})(jQuery);(function($){$.fn.tabsShow=function(Index){var object=$(this);var titles=object.find(".titles a");
var pages=object.find(".pages .page");titles.each(function(index){if(index==Index)$(this).addClass("active");else $(this).removeClass("active")});pages.each(function(index){if(index==Index)$(this).show();else $(this).hide()})}})(jQuery);(function($){$.fn.tabsAccordionSwitch=function(number){var object=$(this);if(typeof number==="undefined")number=0;var pages=object.find(".page");var titles=pages.children("a.title");var contents=pages.children(".content");if(pages.length)pages.each(function(index){var title=
$(this).children("a.title");var content=$(this).children(".content");if(index==number){title.addClass("active");content.show()}});if(systemParameters.mobileDevice.isPC){if(pages.length){var tabWidth=Math.ceil(100/pages.length);pages.each(function(index){var title=$(this).children("a.title");title.css({"left":tabWidth*index+"%"});title.css({"width":tabWidth+"%"})});$(pages[pages.length-1]).find("a.title").css({"left":"auto"});$(pages[pages.length-1]).find("a.title").css({"right":"0px"});titles.on("click",
function(event){titles.removeClass("active");contents.hide();$(this).addClass("active");$(this).parent().children(".content").show();event.preventDefault()})}}else if(systemParameters.mobileDevice.isCellPhone)titles.on("click",function(event){if(!$(this).hasClass("active")){titles.removeClass("active");contents.hide();$(this).addClass("active")}else $(this).removeClass("active");$(this).parent().children(".content").slideToggle(500);event.preventDefault()})}})(jQuery);(function($){$.fn.showMore=function(delay){var object=
$(this);var title=object.find("a.more");var titleBorder=object.find("a.more .border");var content=object.find(".content");var contentHeight=0;var contentBorder=object.find(".content .border");var duration=delay;contentHeight=content.height();if(content.hasClass("bottom"))content.css({"height":"0px"});title.click(function(){var icon=$(this).find("span.arrow");if(content.hasClass("top")){var htmlContent='<div class="review"><div class="name"><b>\u041a\u043e\u043d\u0441\u0442\u0430\u043d\u0442\u0438\u043d \u041a\u043e\u043d\u0441\u0442\u0430\u043d\u0442\u0438\u043d\u043e\u043f\u043e\u043b\u044c\u0441\u043a\u0438\u0439</b></div><div class="rating"><span class="active">&nbsp;</span><span class="active">&nbsp;</span><span class="active">&nbsp;</span><span class="active">&nbsp;</span><span>&nbsp;</span></div><div class="description"><div class="parameter"><div class="type">\u0414\u043e\u0441\u0442\u043e\u0438\u043d\u0441\u0442\u0432\u0430:</div><div class="amount">\u041e\u0447\u0435\u043d\u044c \u0443\u0434\u043e\u0431\u043d\u043e\u0435 \u043c\u0435\u043d\u044e, \u043a\u0440\u0430\u0441\u0438\u0432\u044b\u0439 \u0434\u0438\u0437\u0430\u0439\u043d</div><div class="clear">&nbsp;</div></div><div class="parameter"><div class="type">\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043a\u0438:</div><div class="amount">\u041f\u0430\u0440\u0443 \u0440\u0430\u0437 \u043f\u043e\u0434\u0433\u043e\u0440\u0435\u043b\u0438 \u043e\u0432\u043e\u0449\u0438</div><div class="clear">&nbsp;</div></div><div class="parameter"><div class="type">\u041a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439:</div><div class="amount">\u041f\u043e\u043b\u043e\u0436\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0439 \u043e\u0442\u0437\u044b\u0432 \u043e \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u043c \u0442\u043e\u0432\u0430\u0440\u0435. \u0417\u0430 \u0441\u043b\u043e\u0432\u0435\u0441\u043d\u044b\u043c\u0438 \u0433\u043e\u0440\u0430\u043c\u0438 \u0434\u0430\u043b\u0435\u043a\u043e-\u0434\u0430\u043b\u0435\u043a\u043e \u0432 \u0441\u0442\u0440\u0430\u043d\u0435 \u0433\u043b\u0430\u0441\u043d\u044b\u0445 \u0438 \u0441\u043e\u0433\u043b\u0430\u0441\u043d\u044b\u0445 \u0436\u0438\u0432\u0443\u0442 \u0440\u044b\u0431\u043d\u044b\u0435 \u0442\u0435\u043a\u0441\u0442\u044b. \u0412\u0434\u0430\u043b\u0438 \u043e\u0442 \u0432\u0441\u0435\u0445 \u0436\u0438\u0432\u0443\u0442 \u043e\u043d\u0438 \u0432 \u0431\u0443\u043a\u0432\u0435\u043d\u043d\u044b\u0445 \u0434\u043e\u043c\u0430\u0445 \u043d\u0430 \u0431\u0435\u0440\u0435\u0433\u0443 \u0431\u043e\u043b\u044c\u0448\u043e\u0433\u043e \u044f\u0437\u044b\u043a\u043e\u0432\u043e\u0433\u043e \u043e\u043a\u0435\u0430\u043d\u0430. \u0412 \u0441\u0442\u0440\u0430\u043d\u0435 \u0433\u043b\u0430\u0441\u043d\u044b\u0445 \u0438 \u0441\u043e\u0433\u043b\u0430\u0441\u043d\u044b\u0445 \u0436\u0438\u0432\u0443\u0442.</div><div class="clear">&nbsp;</div></div></div><div class="vote"><span>\u041f\u043e\u043b\u0435\u0437\u043d\u044b\u0439 \u043e\u0442\u0437\u044b\u0432?</span><a href="#">\u0414\u0430</a><span>(5)</span><span>|</span><a href="#">\u041d\u0435\u0442</a><span>(0)</span></div></div>';
content.append(htmlContent);var tempHeight=contentHeight;contentHeight=content.height();content.css({"height":tempHeight});content.animate({height:contentHeight},duration,function(){content.css({"height":"auto"})})}if(content.hasClass("bottom"))if(content.height()==0){content.animate({height:contentHeight},duration);icon.addClass("close");titleBorder.hide();contentBorder.show()}else{content.animate({height:"0px"},duration);icon.removeClass("close")}return false});if(content.hasClass("bottom"))title.hover(function(){if(content.height()==
0)titleBorder.show()},function(){titleBorder.hide()})}})(jQuery);(function($){$.fn.customScroll=function(){var object=$(this);var height=0;var images=object.find("img");var imagesCount=images.length;var imagesCounter=0;var cartProductTopOffset=$(".card-product .card-product-details").offset();cartProductTopOffset=cartProductTopOffset.top-50;if(imagesCount>0)images.one("load",function(){imagesCounter++;if(imagesCounter==imagesCount)$(window).scroll(function(){height=object.height();var heightLeftBlock=
object.parent().height();var top=$(document).scrollTop()-cartProductTopOffset;if(top>0){object.addClass("absolute");if(top<heightLeftBlock-height)object.css({"top":top});else object.css({"top":heightLeftBlock-height})}else{object.removeClass("absolute");object.css({"top":"auto"})}})}).each(function(){if(this.complete)$(this).load()});else $(window).scroll(function(){height=object.height();var heightLeftBlock=object.parent().height();var top=$(document).scrollTop()-cartProductTopOffset;if(top>0){object.addClass("absolute");
if(top<heightLeftBlock-height)object.css({"top":top});else object.css({"top":heightLeftBlock-height})}else{object.removeClass("absolute");object.css({"top":"auto"})}})}})(jQuery);(function($){$.fn.customMapScroll=function(){var object=$(this);var height=object.height();var pickpoints=object.parent();var mapTopOffset=object.offset();if(typeof mapTopOffset!=="undefined")mapTopOffset=mapTopOffset.top-50;else mapTopOffset=0;$(window).scroll(function(){var top=$(document).scrollTop()-mapTopOffset;pickpointsHeight=
pickpoints.height();if(top>0)if(top<pickpointsHeight-height)object.css({"top":top});else object.css({"top":pickpointsHeight-height-2});else object.css({"top":"auto"})})}})(jQuery);(function($){$.fn.productCarousel=function(duration){var object=$(this);var ulItems=object.find("ul.items");var item=object.find(".items-block ul.items .item");var isMoving=false;var initTimer;if(item.length){var animationDuration=duration;var wrapWidth=object.find(".items-block").width();var blockWidth=item.width()+1;var productsPerBlock=
Math.round(wrapWidth/blockWidth);if(isNaN(productsPerBlock)||productsPerBlock===-Infinity)productsPerBlock=0;var productsTotalCount=item.length;if(productsTotalCount>productsPerBlock&&productsPerBlock>0){var blocksTotalCount=Math.ceil(productsTotalCount/productsPerBlock);if(isNaN(blocksTotalCount))blocksTotalCount=1;var need=blocksTotalCount*productsPerBlock-productsTotalCount;if(productsTotalCount>=productsPerBlock)item.each(function(index){if(index<need)object.find(".items-block ul.items").append("<li class='item'>"+
$(this).html()+"</li>")});else if(productsTotalCount==1){var tries=0;for(var i=0;i<need&&tries<need;i++){while(typeof item[i]=="undefined"){i--;tries++}object.find(".items-block ul.items").prepend("<li class='item'>"+$(item[i]).html()+"</li>")}}var tries=0;for(var i=0;i<productsPerBlock&&tries<productsPerBlock;i++){while(typeof item[i]=="undefined"){i=0;tries++}object.find(".items-block ul.items").append("<li class='item'>"+$(item[i]).html()+"</li>")}var tries=0;for(var i=need-1;i>=0&&tries<need;i--){while(typeof item[i]==
"undefined"){i--;tries++}object.find(".items-block ul.items").prepend("<li class='item'>"+$(item[i]).html()+"</li>")}var start=productsTotalCount+need-productsPerBlock;var tries=0;for(var i=productsTotalCount-1;i>=start&&tries<productsTotalCount;i--){while(typeof item[i]=="undefined"){i--;tries++}object.find(".items-block ul.items").prepend("<li class='item'>"+$(item[i]).html()+"</li>")}var itemsBlockWidth=(productsTotalCount+need+productsPerBlock*2)*blockWidth;object.find(".items-block ul.items").width(itemsBlockWidth);
object.find(".items-block ul.items").css({"left":-(productsPerBlock*blockWidth)});object.find("a.right-nav").click(function(){if(!isMoving){isMoving=true;var itemsBlock=$(this).parent().find("ul.items");$(this).parent().find("ul.items").animate({left:"-="+productsPerBlock*blockWidth},animationDuration,function(){if(ulItems.css("left")==-(itemsBlockWidth-productsPerBlock*blockWidth)+"px")itemsBlock.css({"left":-(productsPerBlock*blockWidth)});isMoving=false})}return false});object.find("a.left-nav").click(function(){if(!isMoving){isMoving=
true;var itemsBlock=$(this).parent().find("ul.items");$(this).parent().find("ul.items").animate({left:"+="+productsPerBlock*blockWidth},animationDuration,function(){if(ulItems.css("left")=="0px")itemsBlock.css({"left":-(itemsBlockWidth-productsPerBlock*2*blockWidth)});isMoving=false})}return false});$(window).resize(function(){clearTimeout(initTimer);initTimer=setTimeout(function(){wrapWidth=object.find(".items-block").width();blockWidth=item.width()+1;productsPerBlock=Math.round(wrapWidth/blockWidth);
object.find(".items-block ul.items").css({"left":-(productsPerBlock*blockWidth)})},250)})}else{object.find("a.right-nav").hide();object.find("a.left-nav").hide();object.find(".items-block").css({"left":"0px"});object.find(".items-block").css({"width":productsTotalCount*blockWidth})}item.on("mouseover",function(){$(this).addClass("hover");$(this).find(".button").addClass("pre-hover")});item.on("mouseout",function(){$(this).removeClass("hover");$(this).find(".button").removeClass("pre-hover")});item.find(".button").on("mouseover",
function(){$(this).addClass("hover")});item.find(".button").on("mouseout",function(){$(this).removeClass("hover")})}}})(jQuery);function UpdateCartTotals(price,count,operation){var updatedTotalPrice=$(".header.fixed .wrap .basket a.title span span.name span.price").text();if(isNaN(updatedTotalPrice)||updatedTotalPrice=="")updatedTotalPrice=0;if(operation=="plus")updatedTotalPrice=parseInt(updatedTotalPrice)+price*count;if(operation=="minus")updatedTotalPrice=parseInt(updatedTotalPrice)-price*count;
var updatedTotalCount=$(".header.fixed .wrap .basket a.title span span.name span.count").text();updatedTotalCount=parseInt(updatedTotalCount);if(isNaN(updatedTotalCount)||updatedTotalCount=="")updatedTotalCount=0;if(operation=="plus")updatedTotalCount=updatedTotalCount+count;if(operation=="minus")updatedTotalCount=updatedTotalCount-count;var isDeliveryFree=false;if(updatedTotalPrice>0&&updatedTotalCount>0){$(".header.fixed .wrap .basket .message ul.items li").each(function(){if($(this).hasClass("free_delivery"))isDeliveryFree=
true});var cityDeliveryRulesPrice=-2;var cityDeliveryRulesNeedToPay=0;var temp=CalculateCityDeliveryRules(updatedTotalPrice);cityDeliveryRulesPrice=temp[0];cityDeliveryRulesNeedToPay=temp[1];if(isDeliveryFree==true||cityDeliveryRulesPrice==0){$(".header.fixed .wrap .basket a.title span span.name").html('<span class="price">'+updatedTotalPrice+'</span> \u0440. (<span class="count">'+updatedTotalCount+"</span> \u0448\u0442.)");if($(".header.fixed .wrap .basket a.title span span.delivery").attr("class")!=
"delivery"){$(".header.fixed .wrap .basket a.title span:not(.name, .name .price, .name .count, .icon)").append("<span class='delivery'>\u0411\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u0430\u044f \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0430</span>");$(".header.fixed .wrap .basket a.title span span.icon").addClass("free")}}else{$(".header.fixed .wrap .basket a.title span span.name").html('\u0412 \u043a\u043e\u0440\u0437\u0438\u043d\u0435 <span class="count">'+updatedTotalCount+'</span> \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u043d\u0430 \u0441\u0443\u043c\u043c\u0443 <span class="price">'+
updatedTotalPrice+"</span> \u0440.");$(".header.fixed .wrap .basket a.title span span.delivery").remove();$(".header.fixed .wrap .basket a.title span span.icon").removeClass("free")}if((cityDeliveryRulesPrice==-1||cityDeliveryRulesPrice>0)&&cityDeliveryRulesNeedToPay>0){var message="\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0435\u0449\u0435 \u043d\u0430 <b>"+cityDeliveryRulesNeedToPay+" \u0440</b> ";if(cityDeliveryRulesPrice==-1)message+="\u0438 \u0432\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043c\u044b \u0434\u043e\u0441\u0442\u0430\u0432\u0438\u043c \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e.";
else if(cityDeliveryRulesPrice>0)message+="\u0438 \u043c\u044b \u0434\u043e\u0441\u0442\u0430\u0432\u0438\u043c \u0437\u0430\u043a\u0430\u0437 \u0432\u0441\u0435\u0433\u043e \u0437\u0430 "+cityDeliveryRulesPrice+"\u0440.";$(".header.fixed .wrap .basket .message .total .info-message .text").html(message);$(".header.fixed .wrap .basket .message .total .info-message").show()}else $(".header.fixed .wrap .basket .message .total .info-message").hide();if(updatedTotalPrice>=500){$(".header.fixed .wrap .basket .message .total span.text").remove();
$(".header.fixed .wrap .basket .message .total a.button").remove();var totalContent=$(".header.fixed .wrap .basket .message .total").html();totalContent+='<a class="button green" href="/personal/buy/order.php" title="\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043a\u043e\u0440\u0437\u0438\u043d\u0443 \u0434\u043b\u044f \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430">\u041e\u0444\u043e\u0440\u043c\u0438\u0442\u044c \u0437\u0430\u043a\u0430\u0437</a>';
$(".header.fixed .wrap .basket .message .total").html(totalContent);$(".header.fixed .wrap .basket").removeClass("not-available")}else{$(".header.fixed .wrap .basket .message .total span.text").remove();$(".header.fixed .wrap .basket .message .total a.button").remove();var totalContent=$(".header.fixed .wrap .basket .message .total").html();totalContent+='<span class="text">\u0421\u0443\u043c\u043c\u0430 \u0437\u0430\u043a\u0430\u0437\u0430 \u0434\u043e\u043b\u0436\u043d\u0430 \u0431\u044b\u0442\u044c \u0431\u043e\u043b\u0435\u0435 500 \u0440.</span>';
$(".header.fixed .wrap .basket .message .total").html(totalContent);$(".header.fixed .wrap .basket").addClass("not-available")}}else{$(".header.fixed .wrap .basket a.title").remove();$(".header.fixed .wrap .basket a.order").remove();$(".header.fixed .wrap .basket .message").remove();$(".header.fixed .wrap .basket .message.product-preview").remove();var basketEmpty='<a class="title" href="#" onclick="return false;">';basketEmpty+="<span>";basketEmpty+='<span class="name">\u041a\u043e\u0440\u0437\u0438\u043d\u0430 \u043f\u0443\u0441\u0442\u0430\u044f</span>';
basketEmpty+='<span class="icon">&nbsp;</span>';basketEmpty+="</span>";basketEmpty+='<div class="border">&nbsp;</div>';basketEmpty+="</a>";$(".header.fixed .wrap .basket").append(basketEmpty)}}$(".header.fixed .wrap .basket").on("click",".message ul.items li.item a.delete",function(){var object=$(this);var productId=object.parent().find(".parameters .counter input").attr("name");productId=productId.split("_");productId=parseInt(productId[1]);var productPrice=parseInt(object.parent().find(".parameters .price").text());
var productCount=parseInt(object.parent().find(".parameters .counter input").val());var ulItems=$(".header.fixed .wrap .basket").find(".message ul.items");var isDeliveryFree=false;UpdateCartTotals(productPrice,productCount,"minus");var spanNameWidth=parseInt($(".header.fixed .wrap .basket a.title span span.name").width());if(isNaN(spanNameWidth))spanNameWidth=0;var spanDelivery=$(".header.fixed .wrap .basket a.title span span.delivery");if(spanNameWidth>95)spanDelivery.css({"font-size":"10px"});else spanDelivery.css({"font-size":"12px"});
object.parent().remove();$(".header.fixed .wrap .basket .message ul.items li.item").each(function(){if($(this).hasClass("free_delivery"))isDeliveryFree=true});if(!isDeliveryFree){$(".header.fixed .wrap .basket a.title span span.delivery").remove();$(".header.fixed .wrap .basket a.title span span.icon").removeClass("free")}var lis=ulItems.find("li");if(lis.length<=3){lis.css({"width":"333px"});switch(lis.length){case 1:ulItems.css({"height":"96px"});break;case 2:ulItems.css({"height":"193px"});break;
case 3:ulItems.css({"height":"290px"});break}if(lis.length==0){$(".header.fixed .wrap .basket").removeClass("active");$(".header.fixed .wrap .basket .fixed-wrap").hide();ulItems.parent().hide()}}ulItems.customScrollbar("resize",true);SaveProductToCookies(productId,0,0,productPrice,true);$("body").append("<img src='//pixel.ritorno.ru/pixel?pid=4957&oid="+productId+"&basket_action=del&sid=118' width='1' height='1' alt=''>");return false});$(".header.fixed .wrap .basket").on("click",".message ul.items li.item .parameters .counter a",
function(){var object=$(this);var productId=object.parent().find("input").attr("name");productId=productId.split("_");productId=parseInt(productId[1]);var productPrice=object.parent().parent().find(".price").text();productPrice=parseInt(productPrice);var productCountInput=object.parent().find("input");var productCount=productCountInput.val();productCount=parseInt(productCount);if(isNaN(productCount))productCount=0;var productResidue=parseInt(object.parent().parent().parent().find("input[name='residue']").val());
if(isNaN(productResidue))productResidue=0;var error=false;if(object.hasClass("minus")){productCount--;if(productCount>0)if(SaveProductToCookies(productId,-1,productResidue,productPrice,false)!=false){productCountInput.val(productCount);UpdateCartTotals(productPrice,1,"minus")}else error=true;else if(SaveProductToCookies(productId,0,productResidue,productPrice,true)!=false){productCountInput.val(0);object.parent().parent().parent().remove();var ulItems=$(".header.fixed .wrap .basket").find(".message ul.items");
var lis=ulItems.find("li");if(lis.length<=3){lis.css({"width":"333px"});switch(lis.length){case 1:ulItems.css({"height":"96px"});break;case 2:ulItems.css({"height":"193px"});break;case 3:ulItems.css({"height":"290px"});break}if(lis.length==0){$(".header.fixed .wrap .basket").removeClass("active");$(".header.fixed .wrap .basket .fixed-wrap").hide();ulItems.parent().hide()}}ulItems.customScrollbar("resize",true);UpdateCartTotals(productPrice,1,"minus");$("body").append("<img src='//pixel.ritorno.ru/pixel?pid=4957&oid="+
productId+"&basket_action=del&sid=118' width='1' height='1' alt=''>")}else error=true}if(object.hasClass("plus"))if(SaveProductToCookies(productId,1,productResidue,productPrice,false)!=false){productCount++;productCountInput.val(productCount);UpdateCartTotals(productPrice,1,"plus")}else error=true;if(error==true){$(".header.fixed .wrap .basket").removeClass("active");$(".header.fixed .wrap .basket").find(".message").hide();var tooltip=$(".header.fixed .wrap .basket .tooltip");tooltip.html("<span class='arrow'>&nbsp;</span>\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043d\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0442\u043e\u0432\u0430\u0440\u0430!");
tooltip.show();clearTimeout(hideBasketTimer);hideBasketTimer=setTimeout(function(){tooltip.hide()},hideBasketTimerValue)}return false});(function($){$.fn.showCategoryDescription=function(duration){var object=$(this);var content=object.find(".content");var contentHeight=content.height();var contentPreview=content.children(".preview-text");var contentDetail=content.children(".detail-text");var showMore=object.find("a.show-more");var showMoreHtml=showMore.html();var showMoreTitle=showMore.prop("title");
if(contentPreview.length==0&&contentDetail.length==0)if(content.text().length>400&&systemParameters.mobileDevice.isPC||content.text().length>300&&systemParameters.mobileDevice.isTabletPC||content.text().length>200&&systemParameters.mobileDevice.isCellPhone)showMore.click(function(event){if(!content.hasClass("open")){content.addClass("open");content.animate({height:content.prop("scrollHeight")},duration,function(){showMore.html("\u0421\u0432\u0435\u0440\u043d\u0443\u0442\u044c<span class='icon close'>&nbsp;</span>");
showMore.prop("title","\u0421\u0432\u0435\u0440\u043d\u0443\u0442\u044c")})}else content.animate({height:contentHeight},duration,function(){showMore.html(showMoreHtml);showMore.prop("title",showMoreTitle);content.removeClass("open")});event.preventDefault()});else{showMore.removeClass("button");showMore.hide()}else showMore.click(function(event){contentDetail.slideToggle(duration,function(){if(!contentDetail.hasClass("open")){contentDetail.addClass("open");showMore.html("\u0421\u0432\u0435\u0440\u043d\u0443\u0442\u044c<span class='icon close'>&nbsp;</span>");
showMore.prop("title","\u0421\u0432\u0435\u0440\u043d\u0443\u0442\u044c")}else{contentDetail.removeClass("open");showMore.html(showMoreHtml);showMore.prop("title",showMoreTitle)}});event.preventDefault()})}})(jQuery);(function($){$.fn.mainMenuManagement=function(duration){var object=$(this);var item=object.find(".item");var aTitle=item.find("a.title");var itemPhone=object.find(".item.phone");var itemPhoneTop=itemPhone.find(".top");var itemPhoneBottom=itemPhone.find(".bottom");var iconInformation=
itemPhone.find(".bottom .icon");var itemCity=object.find(".item.city");var itemsAggregator=object.find(".items-aggregator");var cityQuestion=itemCity.find(".question");var cityQuestionButton=cityQuestion.find(".button");var tooltipIndex=0;var zIndex=$(".header.catalog-search").css("z-index");var cityNameInputValue="";var cityDataJSON;aTitle.click(function(event){var obj=$(this);var parent=obj.parent();var content=parent.find(".content:not(.question)");var fixedWrap=parent.find(".fixed-wrap");var spanIcon=
obj.find("span span.icon");if(content.css("display")=="none")if(parent.hasClass("city"))if(content.html()==""||content.html()=="&nbsp;")$.post("/ajax/city_list.php",{"action":"get_cities","current_url":window.location.href},function(data){content.html(data);fixedWrap.show();content.show();spanIcon.addClass("open");parent.addClass("open");parent.find(".content.question").hide();cityDataJSON=itemCity.find(".content .city-data");cityDataJSON=$.parseJSON(decodeURIComponent(cityDataJSON.html()));var ul=
content.find(".cities.other ul");ul.customScrollbar({preventDefaultScroll:true});ul.on("customScroll",function(event,scrollData){if(scrollData.scrollPercent==0||scrollData.scrollPercent>=100)$(this).mousewheel(function(event){event.preventDefault()})});$(".header.catalog-search").css({"z-index":1})});else{fixedWrap.show();content.show();spanIcon.addClass("open");parent.addClass("open");parent.find(".content.question").hide();$(".header.catalog-search").css({"z-index":1})}else{fixedWrap.show();content.show();
spanIcon.addClass("open");parent.addClass("hover");parent.find(".content.question").hide();if(systemParameters.mobileDevice.isCellPhone)event.stopPropagation()}else{if(parent.hasClass("city")){fixedWrap.hide();content.hide();spanIcon.removeClass("open");parent.removeClass("open");$(".header.catalog-search").css({"z-index":zIndex})}if(systemParameters.mobileDevice.isCellPhone){fixedWrap.hide();content.hide();spanIcon.removeClass("open");parent.removeClass("hover");event.stopPropagation()}}if(obj.hasClass("wholesale"))return true;
event.preventDefault()});cityQuestionButton.click(function(event){var obj=$(this);if(obj.hasClass("no")){itemCity.find("a.title").click();cityQuestion.hide();event.preventDefault()}});iconInformation.click(function(event){var obj=$(this);var message=obj.parent().find(".message");var fixedWrap=obj.parent().parent().find(".fixed-wrap");if(message.css("display")=="none"){fixedWrap.show();message.show();obj.addClass("active");var timer=setTimeout(function(){if(message.css("display")=="block"){message.hide();
fixedWrap.hide();obj.removeClass("active")}},3E4)}event.preventDefault()});$(".header .column.right .menu .item.new.info .phone .icon").click(function(event){var obj=$(this);var message=obj.find(".message");var fixedWrap=obj.find(".fixed-wrap");if(message.css("display")=="none"){fixedWrap.show();message.show();obj.addClass("active");var timer=setTimeout(function(){if(message.css("display")=="block"){message.hide();fixedWrap.hide();obj.removeClass("active")}},3E4)}event.preventDefault()});itemCity.on("keyup",
"form input[type='text']",function(event){var tooltip=itemCity.find(".content .tooltip");if(event.keyCode!=38&&event.keyCode!=40&&event.keyCode!=13){var value=$(this).val();if(value.length>=2)if(typeof cityDataJSON==="object"){var firstLetterExist=false;for(var letter in cityDataJSON)if(value[0].toLowerCase()==letter.toLowerCase()){firstLetterExist=true;tooltip.find("ul").html("");var cityExist=false;for(var name in cityDataJSON[letter]){cityDataJSON[letter][name]=cityDataJSON[letter][name].replace("+",
" ");if(cityDataJSON[letter][name].substring(0,value.length).toLowerCase()==value.toLowerCase()){cityExist=true;tooltip.addClass("data");tooltip.find("ul").append("<li><a href='?city="+name+"' title='"+cityDataJSON[letter][name]+"'>"+cityDataJSON[letter][name]+"</a></li>");itemCity.find("form").removeClass("error")}}if(!cityExist){itemCity.find("form").addClass("error");tooltip.removeClass("data");tooltip.find("ul").html("<li><span class='error'>\u0414\u0430\u043d\u043d\u043e\u0433\u043e \u0433\u043e\u0440\u043e\u0434\u0430 \u043d\u0435\u0442 \u0432 \u0431\u0430\u0437\u0435 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430</span></li>")}}if(!firstLetterExist){itemCity.find("form").addClass("error");
tooltip.removeClass("data");tooltip.find("ul").html("<li><span class='error'>\u0414\u0430\u043d\u043d\u043e\u0433\u043e \u0433\u043e\u0440\u043e\u0434\u0430 \u043d\u0435\u0442 \u0432 \u0431\u0430\u0437\u0435 \u043c\u0430\u0433\u0430\u0437\u0438\u043d\u0430</span></li>")}}}else{switch(event.keyCode){case 38:tooltipIndex--;break;case 40:tooltipIndex++;break}if(tooltipIndex<0)tooltipIndex=0;else if(tooltipIndex>tooltip.find("a").length-1)tooltipIndex=tooltip.find("a").length-1;tooltip.find("ul li a").removeClass("hover");
tooltip.find("ul li a").each(function(index){if(index==tooltipIndex){$(this).addClass("hover");if(event.keyCode==13)SubmitCity($(this).attr("href"))}})}});itemCity.on("submit","form",function(){return false});itemCity.on("mousedown","form input[type='submit']",function(event){var input=$(this).parent().find("input[type='text']");var value=input.val();var cityID;if(value.length>=2)$.post("/ajax/citys.php",{"action":"get_city_header","str":value},function(data,textStatus,jqXHR){if(data!=""){var city=
$($(data)[0]).find("a");cityID=city.attr("href");input.val(city.text());SubmitCity(cityID)}})});itemCity.on("mouseover",".tooltip ul li a",function(){$(this).addClass("hover")});itemCity.on("mouseleave",".tooltip ul li a",function(){$(this).removeClass("hover")});function SubmitCity(cityID){if(typeof cityID!=="undefined"){cityID=cityID.split("=");if(typeof cityID[1]!=="undefined"){cityID=parseInt(cityID[1]);if(isNaN(cityID))cityID=0;if(cityID!=0){var url="";if(document.location.search=="")url="?city="+
cityID;else url=document.location.href+"&city="+cityID;document.location.href=url}}}return false}if(systemParameters.mobileDevice.isCellPhone){itemsAggregator.children("a.title").on("click",function(event){if(!itemsAggregator.hasClass("hover"))itemsAggregator.addClass("hover");else itemsAggregator.removeClass("hover");event.preventDefault();event.stopPropagation()});$("body").on("click",function(){if(itemsAggregator.hasClass("hover"))itemsAggregator.removeClass("hover")})}}})(jQuery);(function($){$.fn.windowScrollToTop=
function(duration){var object=$(this);object.click(function(event){var top=$(document).scrollTop();if(top>0)$("html, body").animate({scrollTop:0},duration);event.preventDefault()});$(window).scroll(function(){var top=$(document).scrollTop();if(top>0)object.addClass("visible");else object.removeClass("visible")})}})(jQuery);(function($){$.fn.popUpMenu=function(duration){var object=$(this);var objectHeight=object.height();var title=object.find("a.title");var titleHeight=title.height();var message=object.find(".message");
var messageHeight=message.height();var parent=object.parent();if(object.hasClass("active"))object.removeClass("active");title.click(function(event){if(object.hasClass("active"))message.slideToggle(duration,function(){object.removeClass("active")});else{parent.find(".item").each(function(){var obj=$(this);if(obj.hasClass("active")||obj.find(".message").css("display")=="block")obj.find(".message").slideToggle(duration,function(){obj.removeClass("active")})});if($(".lt-invite").hasClass("lt-active"))$(".lt-label").trigger("click");
message.slideToggle(duration,function(){object.addClass("active")})}event.preventDefault()})}})(jQuery);(function($){$.fn.pickToday=function(){var object=$(this);var title=object.find(".title a");var locationList=object.find(".locations");var locationHeight=0;var locations=object.find(".locations ul li");var cardProductDesc=$(".card-product-desc");var cardProductDescHeight=cardProductDesc.height();var id=object.attr("id");var duration=500;locationHeight=locationList.height();if(object.hasClass("open"))locationList.show();
title.click(function(){var icon=$(this).find("span.icon");if(cardProductDesc.hasClass("absolute")){var top=cardProductDesc.css("top");top=parseInt(top.substring(0,top.length-2));top-=locationHeight;cardProductDesc.animate({top:top},duration)}var pickToday=$(".pick-today:not(#"+id+")");if(pickToday.length>1){pickToday.find(".locations").hide();pickToday.find(".title a span.icon").removeClass("close");pickToday.find(".locations ul li").removeClass("active")}locationList.slideToggle(duration);if(icon.hasClass("close"))icon.removeClass("close");
else icon.addClass("close");return false});title.mouseover(function(){$(this).addClass("hover")});title.mouseleave(function(){$(this).removeClass("hover")});locations.click(function(){locations.removeClass("active");$(this).addClass("active")})}})(jQuery);(function($){$.fn.dropDown=function(duration){var object=$(this);var title=object.children(".title").children("a");var icon=title.find("span.icon");var content=object.children(".content");var contentHeight=0;contentHeight=content.height();if(contentHeight!=
null){if(object.hasClass("open")){content.show();icon.addClass("close")}title.on("click",function(event){var ico=$(this).find("span.icon");content.slideToggle(duration,function(){if(ico.hasClass("close")){ico.removeClass("close");object.removeClass("open")}else{ico.addClass("close");object.addClass("open")}});event.preventDefault()})}else{var options=object.find(".options");var optionCount=0,minOptionHeight=1E3,maxOptionHeight=0,minHeight=0,maxHeight=0;object.find("a:not(.icon)").each(function(){var height=
$(this).height()+2;optionCount++;maxHeight+=height;if(height<=minOptionHeight)minOptionHeight=height;if(height>=maxOptionHeight)maxOptionHeight=height});minHeight=minOptionHeight;if(minHeight!=maxHeight){options.css({"height":minHeight});options.find("a").click(function(event){if($(this).hasClass("selected")||$(this).hasClass("icon"))if(options.height()==minHeight)options.animate({height:maxHeight},duration);else options.animate({height:minHeight},duration);else{options.find("a.selected").text($(this).text());
options.find("a.selected").attr({"id":$(this).attr("id")});options.css({"height":minHeight})}event.preventDefault()})}else{options.find("a").removeClass("active");options.find("a").addClass("selected");options.find("a").css({"cursor":"default"});options.find("a").click(function(event){event.preventDefault()});options.find(".icon").hide()}}}})(jQuery);(function($){$.fn.showAdvertisement=function(duration){var object=$(this);var title=object.find("a.title");var content=object.find(".content");var contentHeight=
content.height();var isAnimating=false;var opened=$.cookie("shag_SITE_ADS");if(typeof opened==="undefined"&&!isAnimating){isAnimating=true;content.height(0);object.removeClass("open");content.animate({height:contentHeight},duration*3,function(){object.addClass("open");opened=true;$.cookie("shag_SITE_ADS",opened,{expires:30,path:"/"});isAnimating=false})}else{opened=$.cookie("shag_SITE_ADS");if(opened==="true")opened=true;else if(opened==="false")opened=false;if(!opened)object.removeClass("open")}title.click(function(event){if(!isAnimating){isAnimating=
true;if(object.hasClass("open"))content.animate({height:0},duration,function(){object.removeClass("open");isAnimating=false;$.cookie("shag_SITE_ADS",false,{expires:30,path:"/"})});else content.animate({height:contentHeight},duration,function(){object.addClass("open");isAnimating=false;$.cookie("shag_SITE_ADS",true,{expires:30,path:"/"})})}event.preventDefault()})}})(jQuery);(function($){$.fn.personalAccount=function(){var object=$(this);if(object.length>0){var address=object.find(".address");var addressInputCount=
object.find("input.adress-input").length;var addressAddButton=address.find(".item .input-wrap .button.address");var phoneInput=object.find("input[name='PERSONAL_PHONE']");var addressCount=1;var addressMaxCount=5;var addressInputLastID=$(object.find("input.adress-input")[addressInputCount-1]).attr("name");var cityButton=object.find(".city .button.change");var iconMessage=object.find("span.icon");var formOrderCancel=object.find(".invoice .footer .total form");addressMaxCount-=addressInputCount;if(typeof addressInputLastID===
"undefined")addressInputLastID=0;if(addressInputLastID!=0){addressInputLastID=addressInputLastID.split("_");addressInputLastID=parseInt(addressInputLastID[addressInputLastID.length-1]);if(isNaN(addressInputLastID))addressInputLastID=0}addressInputLastID++;if(phoneInput.length>0)phoneInput.mask("+7 (999) 999-99-99");object.on("change","input[type='checkbox']",function(){var object=$(this);var icon=object.parent().find("span.icon");if(object.prop("checked"))icon.addClass("active");else icon.removeClass("active")});
object.on("click","label span.icon",function(event){var icon=$(this);icon.parent().find("input[type='checkbox']").click();event.preventDefault()});addressAddButton.on("click",function(event){if(addressCount<=addressMaxCount){var object=$(this);var inputWrap=object.parent().clone();inputWrap.find(".button").remove();inputWrap.find("input").val("");inputWrap.find("input").attr("name","NEW_CITY_ADDRESS_"+addressInputLastID);object.parent().parent().append(inputWrap);addressCount++;addressInputLastID++}event.preventDefault()});
cityButton.on("click",function(event){$("html, body").animate({scrollTop:0},500,function(){$(".header .item.city a.title").click()});event.preventDefault()});iconMessage.on("click",function(event){var object=$(this);var message=object.find(".message");var fixedWrap=object.find(".fixed-wrap");var timer;if(message.css("display")=="none"){fixedWrap.show();message.show();object.addClass("active");timer=setTimeout(function(){fixedWrap.hide();message.hide();object.removeClass("active")},3E4)}});formOrderCancel.each(function(){var form=
$(this);var step1=form.find(".step.one");var step2=form.find(".step.two");var button=form.find(".button");var select=form.find("select");button.on("click",function(event){step1.hide();step2.show()});select.change(function(){var value=$(this).val();if(value!=0)form.submit()});form.submit(function(){return true})})}}})(jQuery);(function($){$.fn.FormValidation=function(useAjax,url,ymTarget){var object=$(this);var reqClassName="required";var reqSessionID;var reqRating;var reqRatingInput;var reqRatingCurrent;
var reqRatingMessage;var reqText;var reqEmail;var reqDate;var reqPhone;var reqInn;var reqKpp;var reqCurAcc;var reqBik;var reqPassword;var reqTextarea;var reqCheckbox;var reqSelect;var file;var fileSuccess=true;reqSessionID=$("input#sessid");reqRating=object.find(".rating span");reqRatingInput=object.find("input[name='rating']");reqRatingCurrent=0;reqRatingMessage=object.find(".rate .error-message");reqText=object.find("input[type='text']."+reqClassName+".text");reqTextarea=object.find("textarea."+
reqClassName);reqEmail=object.find("input[type='text']."+reqClassName+".email");reqPassword=object.find("input[type='password']."+reqClassName+".text");reqPhone=object.find("input[type='text']."+reqClassName+".phone");file=object.find("input[type='file']");if(reqRating.length>0){reqRating.hover(function(){var Index=$(this).index();reqRating.removeClass("active");reqRating.each(function(index){if(index<=Index)$(this).addClass("active")})},function(){reqRating.removeClass("active");reqRating.each(function(){if($(this).index()<
reqRatingCurrent)$(this).addClass("active")})});reqRating.click(function(event){if(reqRatingInput.length>0){reqRatingCurrent=$(this).index()+1;reqRatingInput.val(reqRatingCurrent);reqRatingMessage.hide()}event.preventDefault()})}if(file.length>0)file.each(function(){$(this).on("change",function(){if(typeof $(this)[0].files==="object"){var success=true;for(var i in $(this)[0].files){i=parseInt(i);if(!isNaN(i)&&success==true)switch($(this)[0].files[i].type){case "text/plain":success=true;break;case "application/vnd.oasis.opendocument.text":success=
true;break;case "application/pdf":success=true;break;default:if(typeof $(this)[0].files[i].name==="string"){var ext=$(this)[0].files[i].name.split(".");if(typeof ext==="object")if($(this)[0].accept.indexOf(ext[ext.length-1])!=-1)success=true;else success=false}else success=false;break}}if(!success){object.find("label.note").show();fileSuccess=false}else{object.find("label.note").hide();fileSuccess=true}}})});reqText.each(function(){var obj=$(this);obj.blur(function(){CheckText(obj)});obj.focus(function(){var errorMessage=
obj.attr("title");if(obj.hasClass("error"))obj.removeClass("error");if(obj.val()==errorMessage)obj.val("")})});reqTextarea.each(function(){var obj=$(this);obj.blur(function(){CheckText(obj)});obj.focus(function(){var errorMessage=obj.attr("title");if(obj.hasClass("error"))obj.removeClass("error");if(obj.val()==errorMessage)obj.val("")})});reqPassword.each(function(){var obj=$(this);obj.blur(function(){CheckPassword(obj)});obj.focus(function(){if(obj.hasClass("error"))obj.removeClass("error")})});
reqEmail.each(function(){var obj=$(this);obj.blur(function(){CheckText(obj);CheckEmail(obj)});obj.focus(function(){var errorMessage=obj.attr("title");if(obj.hasClass("error"))obj.removeClass("error");if(obj.val()==errorMessage)obj.val("")})});reqPhone.each(function(){var obj=$(this);obj.mask("+7 (999) 999-99-99");obj.blur(function(){CheckText(obj)});obj.focus(function(){if(obj.hasClass("error"))obj.removeClass("error")})});object.submit(function(){var hasName=true,hasEmail=true,hasComment=true,hasPassword=
true,hasPhone=true;var hasRating=CheckRating();reqText.each(function(){var obj=$(this);hasName=CheckText(obj)});reqPassword.each(function(){var obj=$(this);hasPassword=CheckPassword(obj)});reqTextarea.each(function(){var obj=$(this);hasComment=CheckText(obj)});reqEmail.each(function(){var obj=$(this);hasEmail=CheckText(obj);hasEmail=CheckEmail(obj)});reqPhone.each(function(){var obj=$(this);hasPhone=CheckText(obj)});if(hasName&&hasEmail&&hasComment&&hasRating&&hasPassword&&hasPhone){if(typeof useAjax===
"undefined")useAjax=false;if(typeof url==="undefined")url="";if(useAjax){AjaxSubmit(url,"post",object);return false}else{if(typeof ymTarget!=="undefined"&&typeof yaCounter10648792!=="undefined")yaCounter10648792.reachGoal(ymTarget);return true}}return false});function CheckText(obj){var errorMessage=obj.attr("title");if(obj.val()==""||obj.val()==errorMessage){obj.val(errorMessage);obj.addClass("error");return false}obj.removeClass("error");return true}function CheckPassword(obj){if(obj.val()==""){obj.addClass("error");
return false}obj.removeClass("error");return true}function CheckEmail(obj){var value=obj.val();var indexOfDog=value.indexOf("@");var indexOfDot=value.indexOf(".");if(indexOfDog<=0||indexOfDot<1||indexOfDog==value.length-1||indexOfDot==value.length-1||indexOfDot==indexOfDog+1){obj.addClass("error");return false}obj.removeClass("error");return true}function CheckRating(){if(reqRatingInput.length>0){var ratingValue=parseInt(reqRatingInput.val());if(!isNaN(ratingValue)&&ratingValue===0){reqRatingMessage.show();
return false}reqRatingMessage.hide()}return true}function AjaxSubmit(url,method,form){var data={},formHeight=0;formHeight=form.height();form.find("input, textarea").each(function(){var name=$(this).attr("name");var value=$(this).val();if(typeof name!=="undefined")data[name]=value});if(typeof reqSessionID.attr("name")!=="undefined")data[reqSessionID.attr("name")]=reqSessionID.val();if(method=="post")$.post(url,data,function(data){var response=JSON.parse(data);if(typeof response==="object"){if(response["error"]==
true)form.html(GetCommonErrorMessageHtml(response["message"]));else{if(typeof response["message"]!=="undefined")form.html(GetCommonMessageHtml(response["message"]));else if(typeof response.redirect_url!=="undefined")document.location.href=response.redirect_url;else if(form.parent().parent().hasClass("quick_order_offer"))form.html(GetCommonMessageHtml("\u0412\u0430\u0448\u0430 \u0437\u0430\u044f\u0432\u043a\u0430 \u043d\u0430 \u043e\u0444\u0435\u0440\u0442\u0443 \u043f\u0440\u0438\u043d\u044f\u0442\u0430. \u0412 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0441 \u0432\u0430\u043c\u0438 \u0441\u0432\u044f\u0436\u0435\u0442\u0441\u044f \u043d\u0430\u0448 \u043c\u0435\u043d\u0435\u0434\u0436\u0435\u0440 \u043f\u043e \u0440\u0430\u0431\u043e\u0442\u0435 \u0441 \u043a\u043e\u0440\u043f\u043e\u0440\u0430\u0442\u0438\u0432\u043d\u044b\u043c\u0438 \u043a\u043b\u0438\u0435\u043d\u0442\u0430\u043c\u0438. \u0412\u044b \u0442\u0430\u043a\u0436\u0435 \u043c\u043e\u0436\u0435\u0442\u0435 \u043e\u0437\u043d\u0430\u043a\u043e\u043c\u0438\u0442\u044c\u0441\u044f \u0441 <a href='/offers/'>\u043e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u043c\u0438 \u0442\u043e\u0432\u0430\u0440\u0430\u043c\u0438 \u0434\u043b\u044f \u043e\u0444\u0435\u0440\u0442 \u043d\u0430 \u041f\u043e\u0440\u0442\u0430\u043b\u0435 \u041f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a\u043e\u0432</a>."));
else form.html(GetCommonMessageHtml("\u0421\u043f\u0430\u0441\u0438\u0431\u043e \u0437\u0430 \u0437\u0430\u043a\u0430\u0437. \u0412 \u0431\u043b\u0438\u0436\u0430\u0439\u0448\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0441 \u0432\u0430\u043c\u0438 \u0441\u0432\u044f\u0436\u0435\u0442\u0441\u044f \u043d\u0430\u0448 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u0438 \u0443\u0442\u043e\u0447\u043d\u0438\u0442 \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u043f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u044f \u0442\u043e\u0432\u0430\u0440\u0430. \u0415\u0441\u043b\u0438 \u0432\u044b \u0436\u0435\u043b\u0430\u0435\u0442\u0435 \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u044c \u0442\u0435\u043a\u0443\u0449\u0438\u0439 \u0437\u0430\u043a\u0430\u0437 \u0434\u0440\u0443\u0433\u0438\u043c \u0442\u043e\u0432\u0430\u0440\u043e\u043c, \u043f\u0440\u043e\u0441\u0442\u043e \u0434\u043e\u0436\u0434\u0438\u0442\u0435\u0441\u044c \u0437\u0432\u043e\u043d\u043a\u0430 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440\u0430."));
if(typeof ymTarget!=="undefined"&&typeof yaCounter10648792!=="undefined")yaCounter10648792.reachGoal(ymTarget)}form.addClass("message");form.height(formHeight);form.show()}})}}})(jQuery);(function($){$.fn.FormSearch=function(){var object=$(this);var searchInput=$("#search_input");var searchInputValue=searchInput.val();var searchSuggestions=object.find(".search-suggestions");var searchSuggestionsTimer;var placeholder="";var currentPosition=-1;object.submit(function(){return FormSubmit(object)});searchInput.keyup(function(event){switch(event.keyCode){case 13:MoveToResult($(this),
0);break;case 38:MoveToResult($(this),1);break;case 40:MoveToResult($(this),-1);break;default:makePreSearch($(this),searchSuggestions);break}});searchInput.hover(function(){searchSuggestions.show()});searchInput.focus(function(){object.addClass("focus");placeholder=searchInput.attr("placeholder");searchInput.attr({"placeholder":""})});searchInput.blur(function(){object.removeClass("focus");searchInput.attr({"placeholder":placeholder})});searchSuggestions.mouseleave(function(){var object=$(this);searchSuggestionsTimer=
setTimeout(function(){object.hide()},500)});function makePreSearch(object,searchSuggestions){var query=object.val();if(query.length>2&&typeof searchSuggestions!=="undefined")if(!object.hasClass("is_busy")){object.addClass("is_busy");$.post("/ajax/search.php",{action:"search",query:query},function(data){object.removeClass("is_busy");if(data){searchSuggestions.addClass("box-shadow-suggestions");searchSuggestions.addClass("border-suggestions");searchSuggestions.html(data).show();searchSuggestions.find(".suggestion-block .suggestion-content ul li a, .search-total a").each(function(){$(this).mouseover(function(){$(this).addClass("hover")});
$(this).mouseleave(function(){$(this).removeClass("hover")})})}else{searchSuggestions.removeClass("box-shadow-suggestions");searchSuggestions.removeClass("border-suggestions")}})}}function MoveToResult(input,direction){if(input.val().length>2)if(searchSuggestions.html().length>1&&searchSuggestions.html().indexOf("search_empty_result")==-1){var links=searchSuggestions.find(".suggestion-block .suggestion-content ul li a, .search-total a");if(typeof links[currentPosition]!=="undefined")$(links[currentPosition]).removeClass("hover");
if(direction==1)currentPosition--;else if(direction==-1)currentPosition++;if(currentPosition<0)currentPosition=0;else if(currentPosition>searchSuggestions.find(".suggestion-block .suggestion-content ul li a").length)currentPosition=searchSuggestions.find(".suggestion-block .suggestion-content ul li a").length;links.each(function(index){if(index==currentPosition){$(this).addClass("hover");if(direction==0)FormSubmit(object,$(this).attr("href"))}})}}function FormSubmit(form,url){if(typeof url!=="undefined"){window.location.href=
url;return false}return true}}})(jQuery);(function($){$.fn.catalogFilters=function(){var object=$(this);if(object.length>0){var dropDown=object.find(".drop-down:not(.tags)");var dropDownClosed=object.find(".drop-down:not(.tags,.open)");var label=object.find("label");var checkBox=object.find("label input[type='checkbox']");var values=object.find(".values input[type='text']");var keyupTimer;var isNewsLetter=false;object.each(function(){if($(this).parent().parent().parent().hasClass("newsletter"))isNewsLetter=
true});if(dropDownClosed.length>0&&!isNewsLetter&&systemParameters.mobileDevice.isCellPhone){object.find(".drop-down:not(.tags,.open)").remove();var newBlock="<div class='drop-down aggregate'><div class='title'><a href='#' title='\u0426\u0435\u043d\u0430'><span>\u041e\u0441\u0442\u0430\u043b\u044c\u043d\u044b\u0435 \u0444\u0438\u043b\u044c\u0442\u0440\u044b<span class='icon'>&nbsp;</span></span></a></div><div class='content' style='overflow:visible;'>";dropDownClosed.each(function(){newBlock+="<div class='drop-down'>";
newBlock+=$(this).html();newBlock+="</div>"});newBlock+="</div></div>";object.append(newBlock);object.find(".drop-down:not(.tags,.open) .drop-down").each(function(index){$(this).dropDown(500)});object.children(".drop-down:not(.tags,.open)").dropDown(500);object.find("label input[type='checkbox']").on("change",function(){var input=$(this);var form=object;var dropDown=input.parent().parent().parent().parent().parent().parent().parent();var label=input.parent();if(input.prop("checked"))label.addClass("active");
else label.removeClass("active");FilterSubmit(form,dropDown,dropDown.offset().top,input.parent().parent().offset().top)});object.find(".values input[type='text']").on("keyup",function(){var input=$(this);clearTimeout(keyupTimer);keyupTimer=setTimeout(function(){var value=parseFloat(input.val());if(isNaN(value))value=0;input.val(value);var minValue=0,maxValue=0;var slider=input.parent().parent().find(".slider");var range=input.parent().parent();input.parent().find("input").each(function(){$(this).addClass("changed");
var currentValue=$(this).val();if(currentValue<value){minValue=currentValue;maxValue=value}if(currentValue>value){maxValue=currentValue;minValue=value}});slider.slider("option","values",[minValue,maxValue]);Range(range,minValue,maxValue)},1500)})}dropDown.each(function(){$(this).dropDown(500)});checkBox.change(function(){var input=$(this);var form=object;var dropDown=input.parent().parent().parent().parent().parent().parent().parent();var label=input.parent();if(input.prop("checked"))label.addClass("active");
else label.removeClass("active");FilterSubmit(form,dropDown,dropDown.offset().top,input.parent().parent().offset().top)});if(navigator.userAgent.match(/msie/i)&&navigator.userAgent.match(/8.0/))label.click(function(event){$(this).find("input").click();event.preventDefault()});values.keyup(function(){var input=$(this);clearTimeout(keyupTimer);keyupTimer=setTimeout(function(){var value=parseFloat(input.val());if(isNaN(value))value=0;input.val(value);var minValue=0,maxValue=0;var slider=input.parent().parent().find(".slider");
var range=input.parent().parent();input.parent().find("input").each(function(){$(this).addClass("changed");var currentValue=$(this).val();if(currentValue<value){minValue=currentValue;maxValue=value}if(currentValue>value){maxValue=currentValue;minValue=value}});slider.slider("option","values",[minValue,maxValue]);Range(range,minValue,maxValue)},1500)})}}})(jQuery);(function($){$.fn.ratingLikes=function(){var object=$(this);var buttonPlus=object.find(".plus");var buttonMinus=object.find(".minus");var buttonLogin=
object.find(".login");var votePlus=object.find(".vote-plus");var voteMinus=object.find(".vote-minus");var voteTotal=object.find(".vote-total");var parameterBlockType=object.find(".data .block-type").text();var parameterBlockId=parseInt(object.find(".data .block-id").text());var parameterUserId=parseInt(object.find(".data .user-id").text());var parameterVoted=parseInt(object.find(".data .voted").text());var messageVoteCounted=object.find(".vote-counted");var messageVoteCompleted=object.find(".vote-completed");
var progress=object.find(".progress");var progressBar=progress.find(".bar");var progressText=progress.find(".text");var numberItems=object.find(".number-items");buttonPlus.on("click",function(event){if(numberItems.length>0)SendVote($(this),parseInt(numberItems.find("input").val()));else SendVote($(this),1);event.preventDefault()});buttonMinus.on("click",function(event){SendVote($(this),0);event.preventDefault()});buttonLogin.on("click",function(event){$(".header.fixed .user a.title").click();event.preventDefault()});
function SendVote(obj,vote){var rating=0;if(parameterUserId!=0&&parameterVoted==0){object.find(".data .voted").text("1");obj.addClass("loading");if(obj.hasClass("red")){obj.removeClass("red");obj.addClass("grey")}$.post("/ajax/like.php",{"type":parameterBlockType,"id":parameterBlockId,"user_id":parameterUserId,"sign":vote},function(data){data=JSON.parse(data);if(typeof data==="object")if(data.success===true){switch(vote){case 0:if(voteMinus.length>0){rating=parseInt(voteMinus.text())+1;if(typeof rating===
"undefined")rating=0;voteMinus.text(rating);buttonMinus.remove()}break;default:if(votePlus.length>0){rating=parseInt(votePlus.text())+1;if(typeof rating==="undefined")rating=0;votePlus.text(rating);buttonPlus.remove()}break}obj.remove();if(messageVoteCounted.length>0)messageVoteCounted.removeClass("hide");if(numberItems.length>0)numberItems.remove();if(progress.length>0){var percent=100/parseInt(voteTotal.text())*rating;if(isNaN(percent)||percent<0)percent=0;else if(percent>100)percent=100;progressBar.animate({"width":percent+
"%"},500,function(){if(percent==100){messageVoteCounted.remove();messageVoteCompleted.removeClass("hide");progressText.text("\u0413\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u043a\u043e\u043d\u0447\u0435\u043d\u043e. \u041a\u043e\u043b\u043b\u0435\u043a\u0442\u0438\u0432\u043d\u0430\u044f \u043f\u043e\u043a\u0443\u043f\u043a\u0430 \u0430\u043a\u0442\u0438\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0430!")}})}}else{obj.removeClass("loading");object.addClass("error");object.find(".fixed-wrap").show();
object.find(".message").html('<span class="arrow">&nbsp;</span>'+data.error)}else{obj.removeClass("loading");object.addClass("error");object.find(".fixed-wrap").show();object.find(".message").html('<span class="arrow">&nbsp;</span>'+"\u041e\u0448\u0438\u0431\u043a\u0430")}})}else{object.addClass("error");object.find(".fixed-wrap").show();if(parameterVoted==1)object.find(".message").html('<span class="arrow">&nbsp;</span>'+"\u0412\u044b \u0443\u0436\u0435 \u0433\u043e\u043b\u043e\u0441\u043e\u0432\u0430\u043b\u0438 \u0437\u0430 \u044d\u0442\u043e\u0442 \u044d\u043b\u0435\u043c\u0435\u043d\u0442.")}}
}})(jQuery);(function($){$.fn.customClipboardEvents=function(){var object=$(this);var refLink=object.attr("href");if(typeof ZeroClipboard!=="undefined"){ZeroClipboard.config({swfPath:"/bitrix/templates/cosmo/css/img/ZeroClipboard.swf"});var client=new ZeroClipboard(object);client.on("ready",function(event){client.on("aftercopy",function(event){$(event.target).parent().find(".done").removeClass("hide");$(event.target).remove()})});client.on("error",function(event){ShowPromptBox()})}else ShowPromptBox();
function ShowPromptBox(){object.on("click",function(event){window.prompt("\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0441\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0441\u044b\u043b\u043a\u0443 \u043d\u0430 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u0441\u043e\u0447\u0435\u0442\u0430\u043d\u0438\u0435 \u043a\u043b\u0430\u0432\u0438\u0448 Ctrl+C",refLink)})}}})(jQuery);(function($){$.fn.brandsManagement=
function(){var object=$(this);var letter=object.find(".alphabet a");var brandsList=object.find(".block.frame ul");letter.click(function(event){var id=$(this).attr("id");id=id.split("_");if(typeof id[1]!=="undefined")id=parseInt(id[1]);if(isNaN(id))id=0;letter.removeClass("active");brandsList.each(function(){if(!$(this).hasClass("hide"))$(this).addClass("hide")});$(this).addClass("active");$("#brand_block_"+id).removeClass("hide");event.preventDefault()})}})(jQuery);(function($){$.fn.quickOrderBlockManagement=
function(duration){var object=$(this);if(object.length>0){var title=object.find(".title a");var titleIcon=title.find(".icon");var content=object.find(".content");var form=object.find("form");if(typeof document.location.search!=="undefined"&&document.location.search.indexOf("success_order")!=-1){titleIcon.addClass("close");content.show()}form.FormValidation(true,"/ajax/quick_order.php","REAL_QUICK_ORDER");title.click(function(event){content.slideToggle(duration,function(){if(!titleIcon.hasClass("close"))titleIcon.addClass("close");
else titleIcon.removeClass("close")});event.preventDefault()})}}})(jQuery);(function($){$.fn.getRetailRocketRecommendation=function(data,delay){var object=$(this);if(!systemParameters.mobileDevice.isCellPhone){var rrData={};if(typeof data.action!=="undefined")rrData.action=data.action;if(typeof data.title!=="undefined")rrData.title=data.title;if(typeof data.productID!=="undefined")rrData.product_id=data.productID;if(typeof data.sectionID!=="undefined")rrData.section_id=data.sectionID;if(typeof data.searchType!==
"undefined")rrData.search_type=data.searchType;if(typeof data.searchValue!=="undefined")rrData.search_value=data.searchValue;if(typeof data.userID!=="undefined")rrData.user_id=data.userID;var timeout=window.setTimeout(function(){$.post("/ajax/recommendations.php",rrData,function(response){if(response.length>1){object.append(response);object.find(".product-carousel").each(function(index){var width=$(this).find("ul.items").width();if(width<=846&&width>=844||width<=676&&width>=674||width==507||width==
338||width==169||width==0)$(this).productCarousel(1500)});$("."+rrData.action).on("click","li.item a.img, li.item .parameters .name a",function(event){var itemID=0;if($(this).hasClass("img"))itemID=$(this).parent().find(".add2basket").attr("onclick");else itemID=$(this).parent().parent().parent().find(".add2basket").attr("onclick");if(typeof itemID==="string"){itemID=itemID.split(")");itemID=itemID[0];itemID=itemID.split(",");itemID=parseInt(itemID[1]);if(isNaN(itemID))itemID=0}if(typeof rrApi!==
"undefined"&&typeof itemID!=="undefined"&&itemID!=0)try{rrApi.recomMouseDown(itemID,rrData.action)}catch(e){}});$("."+rrData.action).on("click","li.item .add2basket",function(event){var itemID=0;itemID=$(this).attr("onclick");if(typeof itemID==="string"){itemID=itemID.split(")");itemID=itemID[0];itemID=itemID.split(",");itemID=parseInt(itemID[1]);if(isNaN(itemID))itemID=0}if(typeof rrApi!=="undefined"&&typeof itemID!=="undefined"&&itemID!=0)try{rrApi.recomAddToCart(itemID,rrData.action)}catch(e){}})}else if(object.parent().hasClass("accordion"))object.parent().hide()})},
delay)}else if(object.parent().hasClass("accordion"))object.parent().hide()}})(jQuery);(function($){$.fn.orderFormMVC=function(){var object=$(this);var MVC={};object.customEvents={0:"onChangeInvoicePrice",1:"onChangeDeliveryPrice",2:"onChangePaymentType",3:"onChangeBonusCount",4:"onChangeTotalPrice",5:"onGetDeliveryType",6:"onGetPaymentType",7:"onGetInvoicePrice",8:"onGetBonusCount",9:"onGetBonusCountCanPay",10:"onGetOrderFormErrors",11:"onSaveOrderForm",12:"onSendPartnerData",13:"onGetPersonType",
500:"onError"};MVC.Model=function(){this.orderFormData={invoicePrice:0,deliveryPrice:0,deliveryType:0,deliveryID:0,deliveryDate:0,deliveryDateStr:0,deliveryDateStrUser:0,deliveryCityIsFree:0,deliveryRules:0,pickupDate:0,pickupDateStr:0,pickupDateStrUser:0,bonusCount:0,bonusCountCanPay:0,bonusCountToPay:0,paymentType:0,paymentElectroMoney:0,personType:0,personLocationID:0,personFID:0,cartTotal:0,cartTotalNoDiscounts:0};this.orderFormErrors={requiredDataMissing:false,requiredDataType:[],requiredEmailMissing:false,
deliveryIDMissing:false,onlinePaymentNotAvailable:false,personFIDMissing:false}};MVC.View=function(object){this.objectForm=object;this.initPlugins;this.setInvoiceTotalPrice;this.setOrderTotalPrice;this.showDeliveryNotice;this.showDeliveryMessage;this.showDeliveryError;this.showPickupMessage;this.showPickupError;this.showPaymentCashless;this.showOnlinePaymentError;this.showPaymentCashlessError;this.showCover;this.onChangeCheckBox;this.sendRitorno;this.reloadOrderForm;var productCount=0;var minProductCount=
1;var maxProductCount=999;this.initPlugins=function(){this.objectForm.find(".accordion").each(function(){$(this).dropDown(500)});this.objectForm.find("input[name='PHONE']").mask("+7 (999) 999-99-99");this.objectForm.find("input[name='F_OFFICE_PHONE']").mask("+7 (999) 999-99-99");this.objectForm.find(".calendar input").datepicker({option:$.datepicker.regional["ru"],changeMonth:false,changeYear:false,beforeShowDay:$.datepicker.noWeekends,showOtherMonths:true,selectOtherMonths:true,dateFormat:"dd.mm.yy",
onClose:function(selectedDate){var data={newDateStr:selectedDate};object.trigger(object.customEvents[1],[data]);var icon=$(".box .section .select .calendar span.icon");if(icon.hasClass("active"))icon.removeClass("active")}});var deliveryType={};this.objectForm.trigger(this.objectForm.customEvents[5],[deliveryType]);if(deliveryType.data=="pickup")deliveryType=1;else deliveryType=0;this.objectForm.find("#DELIVERY_TYPE").tabsSwitch(deliveryType);this.showDeliveryMessage();var paymentType={};this.objectForm.trigger(this.objectForm.customEvents[6],
[paymentType]);switch(paymentType.data){case "cash":paymentType=0;break;case "cashless":paymentType=1;break;case "electromoney":paymentType=2;break;default:paymentType=0;break}this.objectForm.find("#PAYMENT_TYPE").tabsSwitch(paymentType);if(paymentType==1){var personType={};this.objectForm.trigger(this.objectForm.customEvents[13],[personType]);var data={personType:personType.data};this.showPaymentCashless(data)}this.showPickupMessage();SetBackgroundSize()};$(window).resize(function(){SetBackgroundSize()});
this.objectForm.on("click",function(event){var target=$(event.target);var targetClass=target.attr("class");if(typeof targetClass==="undefined"){target=target.parent();targetClass=target.attr("class")}if(typeof targetClass!=="undefined"){while(targetClass.indexOf(" ")!=-1)targetClass=targetClass.replace(" ","");switch(targetClass){case "plus":case "minus":var input=target.parent().find("input");var changePriceValue=0;var product={id:0,count:parseInt(input.val()),price:parseInt(target.parent().parent().parent().find(".price").text()),
priceTotalHtml:target.parent().parent().parent().find(".total"),residue:parseInt(input.attr("size"))};if(isNaN(product.count))product.count=0;if(isNaN(product.price))product.price=0;product.id=input.attr("name").split("_");product.id=parseInt(product.id[1]);if(isNaN(product.id))product.id=0;if(isNaN(product.residue))product.residue=0;if(targetClass=="minus"){product.count--;if(product.count<=0){product.count=1;target.addClass("inactive")}else{target.removeClass("inactive");changePriceValue=product.price*
-1;SaveProductToCookies(product.id,-1,product.residue,product.price,false)}}else{product.count++;if(product.count>999)product.count=999;else{target.parent().find("a.minus").removeClass("inactive");SaveProductToCookies(product.id,1,product.residue,product.price,false);changePriceValue=product.price}}if(product.residue>0&&product.count>product.residue)product.count=product.residue;input.val(product.count);product.priceTotalHtml.text(product.price*product.count+" \u0440.");delete product;$(this).trigger(object.customEvents[0],
[changePriceValue]);event.preventDefault();break;case "delete":var product={id:0,price:parseInt(target.parent().find(".price").text())*parseInt(target.parent().find(".counter input").val())*-1,row:target.parent()};product.id=target.parent().find(".count .counter input").attr("name");product.id=product.id.split("_");product.id=parseInt(product.id[1]);product.row.remove();SaveProductToCookies(product.id,0,0,0,true);$(this).trigger(object.customEvents[0],[product.price]);var data={partner:"Ritorno",
product:product.id};$(this).trigger(object.customEvents[12],[data]);delete product;event.preventDefault();break;case "coverwhite":var loader=target.parent().find(".loader");loader.show();var success={data:false};$(this).trigger(object.customEvents[11],function(result){success.data=result});if(success.data===true){var formData={};$(this).find("input").each(function(){var input=$(this);formData[input.attr("name")]=input.val()});$(this).find("textarea").each(function(){var input=$(this);formData[input.attr("name")]=
input.val()});formData["refresh"]=1;var cityID=parseInt($.cookie("shag_OS_CITY_ID_NEW"));if(isNaN(cityID))cityID=0;formData["city"]=cityID;$.post("/ajax/refresh_order.php",formData,function(data){$(".order-form").remove();$(".main_content").append(data);$(".order-form").orderFormMVC()})}event.preventDefault();break;case "buttongreyfloatinglogin":$(".header.fixed .user a.title").click();event.preventDefault();break;case "icon":case "iconquestion":case "iconfloating":var message=target.parent().find(".message");
var fixedWrap=target.parent().find(".fixed-wrap");var timer;if(message.css("display")=="none"){fixedWrap.show();message.show();target.addClass("active");timer=setTimeout(function(){fixedWrap.hide();message.hide();target.removeClass("active")},3E4)}if(target.parent().hasClass("checkbox"))target.parent().find("input").click();if(target.parent().hasClass("calendar")){SetUpCalendar(model.orderFormData.deliveryType);target.parent().find("input").datepicker("show");target.addClass("active")}event.preventDefault();
break;case "iconactive":if(target.parent().hasClass("checkbox"))target.parent().find("input").click();event.preventDefault();break;case "fixed-wrap":var message=target.parent().find(".message");if(message.css("display")=="block"){target.hide();message.hide();target.parent().removeClass("active")}event.preventDefault();break;case "buttongreychange":var element="html";if($(element).scrollTop()==0)element="body";$(element).animate({scrollTop:0},500,function(){if(!$(".header .item.city").hasClass("open"))$(".header .item.city a.title").click()});
event.preventDefault();break;case "deliveryactive":case "pickupactive":var data={deliveryType:"delivery"};if(targetClass=="pickupactive")data.deliveryType="pickup";$(this).trigger(object.customEvents[1],[data]);break;case "cashactive":case "cashlessactive":case "electromoneyactive":var data={paymentType:"cash"};if(targetClass=="cashlessactive")data.paymentType="cashless";else if(targetClass=="electromoneyactive"){data.paymentType="electromoney";var deliveryType={};$(this).trigger(object.customEvents[5],
[deliveryType]);if(deliveryType.data=="pickup")if($("#delivery-pickup").find("option:selected").data("can-pay-online")==0){var data={onlinePaymentNotAvailable:true};object.trigger(object.customEvents[500],[data])}}$(this).trigger(object.customEvents[2],[data]);break}}});$(".header .menu .item.city .content").on("click",".cities ul a",function(event){var obj=$(this);var cityName=obj.text();var cityID=0;var uri=obj.attr("href");uri=uri.split("?");if(typeof uri==="object")for(var field in uri)if(uri[field].indexOf("city")!=
-1){uri=uri[field].split("&");if(typeof uri==="object")for(var f in uri){var temp=uri[f].split("=");if(typeof temp[0]!=="undefined"&&typeof temp[1]!=="undefined"&&temp[0]=="city")cityID=parseInt(temp[1])}}var success={data:false};object.trigger(object.customEvents[11],function(result){success.data=result});if(success.data===true){var formData={};object.find("input").each(function(){var input=$(this);formData[input.attr("name")]=input.val()});object.find("textarea").each(function(){var input=$(this);
formData[input.attr("name")]=input.val()});formData["refresh"]=1;formData["city"]=cityID;$.post("/ajax/refresh_order.php",formData,function(data){$(".order-form").remove();$(".main_content").append(data);$(".order-form").orderFormMVC();$(".header .item.city a span span.name").text(cityName);$(".header .item.city .content").hide();$(".header .item.city .fixed-wrap").hide();$(".header .item.city").removeClass("open");$(".header .item.city a.title span span.icon").removeClass("open");var top=$(".box .section .city").offset().top-
29;$("html, body").animate({scrollTop:top},500)})}event.preventDefault()});$(".add2basket").on("click",function(event){var productId=0;productId=$(this).attr("onclick").split(";");if(typeof productId==="object"){productId=productId[0];productId=productId.split(",");if(typeof productId==="object"){productId=parseInt(productId[1]);if(isNaN(productId))productId=0}}var success={data:false};object.trigger(object.customEvents[11],function(result){success.data=result});if(success.data===true){var formData=
{};object.find("input").each(function(){var input=$(this);formData[input.attr("name")]=input.val()});object.find("textarea").each(function(){var input=$(this);formData[input.attr("name")]=input.val()});formData["refresh"]=1;var cityID=parseInt($.cookie("shag_OS_CITY_ID_NEW"));if(isNaN(cityID))cityID=0;formData["city"]=cityID;$.post("/ajax/refresh_order.php",formData,function(data){$(".order-form").remove();$(".main_content").append(data);$(".order-form").orderFormMVC();var top=0;$(".box .section .invoice .row").each(function(){if($(this).find("input").attr("name")==
"product_"+productId){$(this).addClass("new");top=$(this).offset().top-29}});$("html, body").animate({scrollTop:top},1E3)})}});this.objectForm.on("change","input, select",function(event){var target=$(event.target);var targetType=target.attr("type");var targetID=target.attr("id");switch(targetType){case "checkbox":var icon=target.parent().find("span.icon");if(target.prop("checked"))icon.addClass("active");else icon.removeClass("active");if(target.parent().hasClass("legal-entity")){var data={};if(target.prop("checked"))data.showActualAddress=
true;else data.showActualAddress=false;$(this).trigger(object.customEvents[2],[data])}break}switch(targetID){case "delivery-delivery":var id=target.find("option:selected").val();if(id!=0)$(this).trigger(object.customEvents[1]);else{var data={deliveryIDMissing:true};object.trigger(object.customEvents[500],[data])}break;case "delivery-pickup":var id=target.find("option:selected").val();var pickpointDetails=target.parent().parent().parent().find("ul.pickup-details li");pickpointDetails.removeClass("active");
if(id!=0){pickpointDetails.each(function(){var pickpointId=$(this).attr("id").split("-");if(typeof pickpointId[1]!=="undefined"){pickpointId=parseInt(pickpointId[1]);if(isNaN(pickpointId))pickpointId=0;if(id==pickpointId)$(this).addClass("active")}});$(this).trigger(object.customEvents[1]);if(target.find("option:selected").data("can-pay-online")==0){var data={onlinePaymentNotAvailable:true};object.trigger(object.customEvents[500],[data])}else HideOnlinePaymentError()}else{var data={deliveryIDMissing:true};
object.trigger(object.customEvents[500],[data])}break;case "payment-cashless":var data={personType:parseInt(target.find("option:selected").val())};$(this).trigger(object.customEvents[2],[data]);break}});this.objectForm.on("focus","input",function(event){var target=$(event.target);var targetType=target.attr("type");var targetName=target.attr("name");switch(targetType){case "text":if(targetName.indexOf("product_")!=-1){productCount=parseInt(target.val());if(isNaN(productCount)||productCount<minProductCount)productCount=
minProductCount;else if(productCount>maxProductCount)productCount=maxProductCount;target.val(productCount)}if(target.hasClass("required")){if(target.hasClass("error"))target.removeClass("error");if(target.val()==target.attr("title"))target.val("")}if(targetName=="BONUS_TO_PAY")if(target.val()==0)target.val("");break}});this.objectForm.on("blur","input",function(event){var target=$(event.target);var targetType=target.attr("type");var targetName=target.attr("name");switch(targetType){case "text":if(targetName.indexOf("product_")!=
-1){var changePriceValue=0;var product={id:target.attr("name"),count:parseInt(target.val()),price:parseInt(target.parent().parent().parent().find(".price").text()),priceTotalHtml:target.parent().parent().parent().find(".total"),residue:parseInt(target.attr("size"))};product.id=product.id.split("_");product.id=parseInt(product.id[1]);if(isNaN(product.count))product.count=productCount;else if(product.count<minProductCount){product.count=minProductCount;target.parent().find("a.minus").addClass("inactive")}else if(product.count>
maxProductCount)product.count=maxProductCount;else if(product.residue>0&&product.count>product.residue)product.count=product.residue;if(product.count>productCount){changePriceValue=product.price*(product.count-productCount);SaveProductToCookies(product.id,product.count-productCount,product.residue,product.price,false)}else if(product.count<productCount){changePriceValue=product.price*(productCount-product.count)*-1;SaveProductToCookies(product.id,(productCount-product.count)*-1,product.residue,product.price,
false)}target.val(product.count);product.priceTotalHtml.text(product.price*product.count+" \u0440.");delete product;$(this).trigger(object.customEvents[0],[changePriceValue])}if(target.hasClass("required"))CheckText(target,target.attr("title"),targetName);if(targetName=="EMAIL")CheckEmail(target,target.attr("title"));if(targetName=="ADDRESS_HOUSE")CheckDigits(target,target.attr("title"),0,targetName);if(targetName=="BONUS_TO_PAY")CheckBonus(target,target.attr("title"));if(targetName=="IP_INN")CheckDigits(target,
target.attr("title"),12,targetName);if(targetName=="F_INN")CheckDigits(target,target.attr("title"),10,targetName);if(targetName=="F_KPP")CheckDigits(target,target.attr("title"),9,targetName);if(targetName=="F_CURRENT_ACCOUNT")CheckDigits(target,target.attr("title"),20,targetName);if(targetName=="F_BIK")CheckDigits(target,target.attr("title"),9,targetName);break}});this.objectForm.on("keyup","input",function(event){var target=$(event.target);var targetName=target.attr("name");if((event.keyCode<37||
event.keyCode>40)&&event.keyCode!=8&&event.keyCode!=46)switch(targetName){case "BONUS_TO_PAY":var value=target.val();value=value.replace(new RegExp("[^0-9]","g"),"");if(value.length>0){var bonusCount={};$(this).trigger(object.customEvents[8],[bonusCount]);bonusCount=bonusCount.data;var bonusCountCanPay={};$(this).trigger(object.customEvents[9],[bonusCountCanPay]);bonusCountCanPay=bonusCountCanPay.data;if(value>bonusCountCanPay)value=bonusCountCanPay;if(value>bonusCount)value=bonusCount;value=parseInt(value);
target.val(value);var data={bonusCountToPay:value};$(this).trigger(object.customEvents[3],[data])}break}});this.objectForm.on("submit",function(event){var errors={};$(this).trigger(object.customEvents[10],[errors]);errors=errors.data;for(var errType in errors)switch(errType){case "requiredDataMissing":$(this).find(".required").each(function(){var input=$(this);var inputName=input.attr("name");switch(inputName){case "CONTACT_PERSON":CheckText(input,input.attr("title"),inputName);break;case "PHONE":CheckText(input,
input.attr("title"),inputName);break;case "EMAIL":CheckText(input,input.attr("title"),inputName);CheckEmail(input,input.attr("title"));break;case "ADDRESS_STREET":if(model.orderFormData.deliveryType=="delivery")CheckText(input,input.attr("title"),inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "ADDRESS_HOUSE":if(model.orderFormData.deliveryType=="delivery"){CheckText(input,input.attr("title"),inputName);CheckDigits(input,
input.attr("title"),0,inputName)}else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "FULL_FIO":if(model.orderFormData.paymentType=="cashless"&&model.orderFormData.personType==1)CheckText(input,input.attr("title"),inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "IP_NAME":if(model.orderFormData.paymentType=="cashless"&&model.orderFormData.personType==
3)CheckText(input,input.attr("title"),inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "F_COMPANY_NAME":if(model.orderFormData.paymentType=="cashless"&&model.orderFormData.personType==2)CheckText(input,input.attr("title"),inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "F_CITY_LEGAL":if(model.orderFormData.paymentType==
"cashless"&&model.orderFormData.personType==2)CheckText(input,input.attr("title"),inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "F_STREET_LEGAL":if(model.orderFormData.paymentType=="cashless"&&model.orderFormData.personType==2)CheckText(input,input.attr("title"),inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "F_INDEX_LEGAL":if(model.orderFormData.paymentType==
"cashless"&&model.orderFormData.personType==2)CheckText(input,input.attr("title"),inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "F_HOUSE_LEGAL":if(model.orderFormData.paymentType=="cashless"&&model.orderFormData.personType==2)CheckText(input,input.attr("title"),inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "F_CITY_FACT":if(model.orderFormData.paymentType==
"cashless"&&model.orderFormData.personType==2&&$("input[name='SAME_ADDRESS']").prop("checked")==false)CheckText(input,input.attr("title"),inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "F_STREET_FACT":if(model.orderFormData.paymentType=="cashless"&&model.orderFormData.personType==2&&$("input[name='SAME_ADDRESS']").prop("checked")==false)CheckText(input,input.attr("title"),inputName);else{var data={requiredDataMissing:false,
requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "F_INDEX_FACT":if(model.orderFormData.paymentType=="cashless"&&model.orderFormData.personType==2&&$("input[name='SAME_ADDRESS']").prop("checked")==false)CheckText(input,input.attr("title"),inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "F_HOUSE_FACT":if(model.orderFormData.paymentType=="cashless"&&model.orderFormData.personType==
2&&$("input[name='SAME_ADDRESS']").prop("checked")==false)CheckText(input,input.attr("title"),inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "BONUS_TO_PAY":CheckBonus(input,input.attr("title"));break;case "IP_INN":if(model.orderFormData.paymentType=="cashless"&&model.orderFormData.personType==3)CheckDigits(input,input.attr("title"),12,inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};
object.trigger(object.customEvents[500],[data])}break;case "F_INN":if(model.orderFormData.paymentType=="cashless"&&model.orderFormData.personType==2)CheckDigits(input,input.attr("title"),10,inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "F_KPP":if(model.orderFormData.paymentType=="cashless"&&model.orderFormData.personType==2)CheckDigits(input,input.attr("title"),9,inputName);else{var data={requiredDataMissing:false,
requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "F_CURRENT_ACCOUNT":if(model.orderFormData.paymentType=="cashless"&&model.orderFormData.personType==2)CheckDigits(input,input.attr("title"),20,inputName);else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break;case "F_BIK":if(model.orderFormData.paymentType=="cashless"&&model.orderFormData.personType==2)CheckDigits(input,input.attr("title"),9,inputName);
else{var data={requiredDataMissing:false,requiredDataType:inputName};object.trigger(object.customEvents[500],[data])}break}});break;case "deliveryIDMissing":if(model.orderFormData.deliveryType=="delivery")if($(this).find("#delivery-delivery option:selected").val()==0){var data={deliveryIDMissing:true};object.trigger(object.customEvents[500],[data])}else{var data={deliveryIDMissing:false};object.trigger(object.customEvents[500],[data])}else if(model.orderFormData.deliveryType=="pickup")if($(this).find("#delivery-pickup option:selected").val()==
0){var data={deliveryIDMissing:true};object.trigger(object.customEvents[500],[data])}else{var data={deliveryIDMissing:false};object.trigger(object.customEvents[500],[data])}break;case "onlinePaymentNotAvailable":if(model.orderFormData.deliveryType=="pickup")if($(this).find("#delivery-pickup option:selected").data("can-pay-online")==0){var data={onlinePaymentNotAvailable:true};object.trigger(object.customEvents[500],[data])}else{var data={onlinePaymentNotAvailable:false};object.trigger(object.customEvents[500],
[data])}else{var data={onlinePaymentNotAvailable:false};object.trigger(object.customEvents[500],[data])}break;case "personFIDMissing":if(model.orderFormData.paymentType=="cashless")if($(this).find("#payment-cashless option:selected").val()==0){var data={personFIDMissing:true};object.trigger(object.customEvents[500],[data])}else{var data={personFIDMissing:false};object.trigger(object.customEvents[500],[data])}else{var data={personFIDMissing:false};object.trigger(object.customEvents[500],[data])}break}var top=
0;if(errors.requiredDataMissing||errors.requiredEmailMissing)if(typeof $(this).find(".required.error").offset()!=="undefined")top=parseInt($(this).find(".required.error").offset().top-40);if(errors.deliveryIDMissing)if(model.orderFormData.deliveryType=="delivery"&&typeof $(this).find("#delivery-delivery").offset()!=="undefined")top=parseInt($(this).find("#delivery-delivery").offset().top-40);else if(model.orderFormData.deliveryType=="pickup"&&typeof $(this).find("#delivery-pickup").offset()!=="undefined")top=
parseInt($(this).find("#delivery-pickup").offset().top-40);if(errors.onlinePaymentNotAvailable&&typeof $(this).find("#electromoney").offset()!=="undefined")if(model.orderFormData.paymentType=="electromoney ")top=parseInt($(this).find("#electromoney").offset().top-40);if(errors.personFIDMissing&&typeof $(this).find("#payment-cashless").offset()!=="undefined")if(model.orderFormData.paymentType=="cashless")top=parseInt($(this).find("#payment-cashless").offset().top-40);if(typeof top!=="undefined"&&top>
0)$("html, body").animate({scrollTop:top},500);else{var success={data:false};$(this).trigger(object.customEvents[11],function(result){success.data=result});return success.data}return false});this.setInvoiceTotalPrice=function(){var invoicePrice={};this.objectForm.trigger(object.customEvents[7],[invoicePrice]);this.objectForm.find(".section .invoice .total .price").text(invoicePrice.data+" \u0440.")};this.setOrderTotalPrice=function(isDeliveryTypeChanged){var formula=this.objectForm.find(".section.total .formula");
var invoice=formula.find(".cart");if(model.orderFormData.invoicePrice==0)invoice.hide();else{invoice.find(".price b").text(model.orderFormData.invoicePrice+" \u0440.");invoice.show()}var delivery=formula.find(".delivery");if(model.orderFormData.deliveryPrice<0)delivery.hide();else if(model.orderFormData.deliveryID==0&&model.orderFormData.deliveryPrice==0&&isDeliveryTypeChanged===true)delivery.hide();else{if(model.orderFormData.deliveryPrice==0)delivery.find(".price b").text("\u0411\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e");
else delivery.find(".price b").text(model.orderFormData.deliveryPrice+" \u0440.");if(model.orderFormData.deliveryType=="delivery")delivery.find(".text").text("(\u0414\u043e\u0441\u0442\u0430\u0432\u043a\u0430)");else if(model.orderFormData.deliveryType=="pickup")delivery.find(".text").text("(\u0421\u0430\u043c\u043e\u0432\u044b\u0432\u043e\u0437)");delivery.show()}var bonus=formula.find(".bonus");if(model.orderFormData.bonusCountToPay==0)bonus.hide();else{bonus.find(".price b").text(model.orderFormData.bonusCountToPay+
" \u0440.");bonus.show();$("input[name='BONUS_TO_PAY']").val(model.orderFormData.bonusCountToPay)}this.objectForm.find(".section.total .content .total span").text(model.orderFormData.cartTotal+" \u0440.")};this.showDeliveryNotice=function(price,needToPay){var message=this.objectForm.find(".invoice .total .info-message");if(price==0){message.find("p").html("\u0411\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u0430\u044f \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0430");message.show()}else if((price==
-1||price>0)&&needToPay>0){if(price==-1)message.find("p").html("\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0435\u0449\u0435 \u043d\u0430 <b>"+needToPay+" \u0440</b> \u0438 \u0432\u0430\u0448 \u0437\u0430\u043a\u0430\u0437 \u043c\u044b \u0434\u043e\u0441\u0442\u0430\u0432\u0438\u043c \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e.");else message.find("p").html("\u0414\u043e\u0431\u0430\u0432\u044c\u0442\u0435 \u0442\u043e\u0432\u0430\u0440\u043e\u0432 \u0435\u0449\u0435 \u043d\u0430 <b>"+
needToPay+" \u0440</b> \u0438 \u043c\u044b \u0434\u043e\u0441\u0442\u0430\u0432\u0438\u043c \u0437\u0430\u043a\u0430\u0437 \u0432\u0441\u0435\u0433\u043e \u0437\u0430 "+price+"\u0440.");message.show()}else message.hide();message.find(".icon").html("&nbsp;")};this.showDeliveryMessage=function(){var select=this.objectForm.find("#DELIVERY_TYPE .page.one .select:not(label.select)");var message=select.children(".comment");var calendar=select.children(".calendar");var error=select.children(".error");var check=
select.children(".check");var textMessage="";if(model.orderFormData.deliveryDate!=0){if(model.orderFormData.deliveryDate=="\u0437\u0430\u0432\u0442\u0440\u0430")textMessage+=" \u0421\u0440\u043e\u043a \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438: <span>"+model.orderFormData.deliveryDate+"</span>. ";else textMessage+=" \u0414\u043e\u0441\u0442\u0430\u0432\u043a\u0430: <span>"+model.orderFormData.deliveryDate+"</span>. ";message.removeClass("date-unavailable")}else{textMessage+=" \u0422\u043e\u0447\u043d\u044b\u0435 \u0441\u0440\u043e\u043a\u0438 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u0432\u0430\u043c \u0441\u043e\u043e\u0431\u0449\u0438\u0442 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043f\u043e\u0441\u043b\u0435 \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430. ";
message.addClass("date-unavailable")}if(model.orderFormData.deliveryID==64)textMessage+=" <span class='free'>\u0411\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u0430\u044f \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0430</span> ";else if(model.orderFormData.deliveryPrice>0)textMessage+=" C\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c: <span><b>"+model.orderFormData.deliveryPrice+"&nbsp;\u0440</b></span>. ";else textMessage+=" \u0422\u043e\u0447\u043d\u0443\u044e \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u0432\u0430\u043c \u0441\u043e\u043e\u0431\u0449\u0438\u0442 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043f\u043e\u0441\u043b\u0435 \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430. ";
if(model.orderFormData.deliveryDate!=0){textMessage+="  ";textMessage+="<span class='icon'>";textMessage+="<div class='fixed-wrap'>&nbsp;</div>";textMessage+="<div class='message'>";textMessage+="<span class='arrow'>&nbsp;</span>";textMessage+="\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u0430\u0442\u0443 \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c.";
textMessage+="</div>";textMessage+="</span>";textMessage+="  "}if(model.orderFormData.deliveryDate==0&&(model.orderFormData.deliveryPrice==0||model.orderFormData.deliveryPrice==-1))textMessage=" \u0422\u043e\u0447\u043d\u044b\u0435 \u0441\u0440\u043e\u043a\u0438 (\u0438 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c) \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u0432\u0430\u043c \u0441\u043e\u043e\u0431\u0449\u0438\u0442 \u043e\u043f\u0435\u0440\u0430\u0442\u043e\u0440 \u043f\u043e\u0441\u043b\u0435 \u043e\u0444\u043e\u0440\u043c\u043b\u0435\u043d\u0438\u044f \u0437\u0430\u043a\u0430\u0437\u0430. ";
if(textMessage!=""){message.html(textMessage);message.show();if(model.orderFormData.deliveryDateStr!=0)calendar.show();check.show();if(model.orderFormData.deliveryDate==0&&(model.orderFormData.deliveryPrice==0||model.orderFormData.deliveryPrice==-1))check.hide();error.hide()}else{message.hide();calendar.hide();check.hide();error.hide()}if(select.find("option").length==1){var deliveryName=select.find(".select select option:selected").text();if(deliveryName!=""){message.prepend("<b>"+deliveryName+"</b><br>");
select.children(".select").hide();check.hide();if(calendar.css("display")=="block")calendar.addClass("margin-top")}}else{select.children(".select").show();if(calendar.hasClass("margin-top"))calendar.removeClass("margin-top")}};this.showDeliveryError=function(){this.objectForm.find("#DELIVERY_TYPE .page.one .select .comment").hide();this.objectForm.find("#DELIVERY_TYPE .page.one .select .calendar").hide();this.objectForm.find("#DELIVERY_TYPE .page.one .select .check").hide();this.objectForm.find("#DELIVERY_TYPE .page.one .select .error").show()};
this.showPickupMessage=function(){var select=this.objectForm.find("#DELIVERY_TYPE .page.two .select:not(label.select)");var pickupDetails=this.objectForm.find("#DELIVERY_TYPE .page.two ul.pickup-details li");var message=select.children(".comment");var calendar=select.children(".calendar");var error=select.children(".error");var check=select.children(".check");var textMessage="";if(model.orderFormData.deliveryID!=0){if(model.orderFormData.pickupDate!=0){textMessage+=" \u0421\u0430\u043c\u043e\u0432\u044b\u0432\u043e\u0437: <span>"+
model.orderFormData.pickupDate+"</span>. ";message.removeClass("date-unavailable")}else{textMessage+=" \u0422\u043e\u0447\u043d\u044b\u0435 \u0441\u0440\u043e\u043a\u0438 \u0441\u0430\u043c\u043e\u0432\u044b\u0432\u043e\u0437\u0430 \u043d\u0435 \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u044b. ";message.addClass("date-unavailable")}if(model.orderFormData.deliveryPrice>0)textMessage+=" C\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0434\u043e\u0441\u0442\u0430\u0432\u043a\u0438 \u0434\u043e \u043f\u0443\u043d\u043a\u0442\u0430 \u0432\u044b\u0434\u0430\u0447\u0438: <span><b>"+
model.orderFormData.deliveryPrice+"&nbsp;\u0440</b></span>. ";else if(model.orderFormData.deliveryPrice==0)textMessage+=" <span class='free'>\u0411\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u044b\u0439 \u0441\u0430\u043c\u043e\u0432\u044b\u0432\u043e\u0437</span> ";if(model.orderFormData.pickupDate!=0){textMessage+="  ";textMessage+="<span class='icon'>";textMessage+="<div class='fixed-wrap'>&nbsp;</div>";textMessage+="<div class='message'>";textMessage+="<span class='arrow'>&nbsp;</span>";textMessage+=
"\u0412\u044b \u043c\u043e\u0436\u0435\u0442\u0435 \u0438\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0434\u0430\u0442\u0443 \u0441\u0430\u043c\u043e\u0432\u044b\u0432\u043e\u0437\u0430, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043a\u0430\u043b\u0435\u043d\u0434\u0430\u0440\u044c.";textMessage+="</div>";textMessage+="</span>";textMessage+="  "}}if(textMessage!=""){message.html(textMessage);message.show();if(model.orderFormData.pickupDateStr!=0)calendar.show();check.show();error.hide()}else{message.hide();
calendar.hide();check.hide();error.hide()}if(select.find("option").length==1){var pickpointName=select.find(".select select option:selected").text();if(pickpointName!=""){message.prepend("\u041f\u0443\u043d\u043a\u0442 \u0432\u044b\u0434\u0430\u0447\u0438 <b>"+pickpointName+"</b><br>");select.children(".select").hide();check.hide();if(calendar.css("display")=="block")calendar.addClass("margin-top")}if(pickupDetails.length==1&&typeof pickupDetails[0]!=="undefined")$(pickupDetails[0]).show()}else{select.children(".select").show();
if(calendar.hasClass("margin-top"))calendar.removeClass("margin-top")}};this.showPickupError=function(){this.objectForm.find("#DELIVERY_TYPE .page.two .select .comment").hide();this.objectForm.find("#DELIVERY_TYPE .page.two .select .calendar").hide();this.objectForm.find("#DELIVERY_TYPE .page.two .select .check").hide();var errors={};this.objectForm.trigger(this.objectForm.customEvents[10],[errors]);errors=errors.data;if(errors.onlinePaymentNotAvailable===true){this.objectForm.find("#DELIVERY_TYPE .page.two .select select option:selected").removeAttr("selected");
this.objectForm.find("#DELIVERY_TYPE .page.two ul.pickup-details li").removeClass("active");this.objectForm.find("#DELIVERY_TYPE .page.two .select .error").text("\u041e\u043f\u043b\u0430\u0442\u0430 \u043a\u0430\u0440\u0442\u043e\u0439 \u0432 \u043e\u043d\u043b\u0430\u0439\u043d\u0435 \u0438 \u043f\u043e\u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0430\u044f \u0432\u044b\u0434\u0430\u0447\u0430 \u0437\u0430\u043a\u0430\u0437\u0430 \u0432 \u044d\u0442\u043e\u043c \u043f\u0443\u043d\u043a\u0442\u0435 \u041d\u0415\u0412\u041e\u0417\u041c\u041e\u0416\u041d\u0410. \u0412\u044b\u0431\u0435\u0440\u0438\u0442\u0435 \u0434\u0440\u0443\u0433\u043e\u0439 \u0441\u043f\u043e\u0441\u043e\u0431 \u043e\u043f\u043b\u0430\u0442\u044b.")}this.objectForm.find("#DELIVERY_TYPE .page.two .select .error").show()};
this.showOnlinePaymentError=function(error){var electroMoneyTab=this.objectForm.find("#PAYMENT_TYPE .titles .electromoney");if(typeof error!=="undefined"&&error===true)electroMoneyTab.hide()};this.showCover=function(){this.objectForm.find(".section:not(.first) .cover").show()};this.showPaymentCashless=function(data){var check=this.objectForm.find("#PAYMENT_TYPE .page.two .select .check");var error=this.objectForm.find("#PAYMENT_TYPE .page.two .select .error");this.objectForm.find(".legal-entity").hide();
if(typeof data!=="undefined"){if(typeof data.personType!=="undefined")switch(data.personType){case 0:this.objectForm.find(".legal-entity").hide();var data={personFIDMissing:true};object.trigger(object.customEvents[500],[data]);break;case 1:this.objectForm.find(".legal-entity").hide();this.objectForm.find(".legal-entity.physical-person").show();check.show();error.hide();break;case 2:this.objectForm.find(".legal-entity").show();this.objectForm.find(".legal-entity.physical-person").hide();this.objectForm.find(".legal-entity.individual").hide();
this.objectForm.find(".legal-entity.actual-address").hide();check.show();error.hide();break;case 3:this.objectForm.find(".legal-entity").hide();this.objectForm.find(".legal-entity.individual").show();check.show();error.hide();break}if(data.showActualAddress===false){this.objectForm.find(".legal-entity").show();this.objectForm.find(".legal-entity.physical-person").hide();this.objectForm.find(".legal-entity.individual").hide()}else if(data.showActualAddress===true){this.objectForm.find(".legal-entity").show();
this.objectForm.find(".legal-entity.physical-person").hide();this.objectForm.find(".legal-entity.individual").hide();this.objectForm.find(".legal-entity.actual-address").hide()}}};this.showPaymentCashlessError=function(data){this.objectForm.find("#PAYMENT_TYPE .page.two .select .check").hide();this.objectForm.find("#PAYMENT_TYPE .page.two .select .error").show()};this.sendRitorno=function(product){$("body").append("<img src='//pixel.ritorno.ru/pixel?pid=4957&oid="+product+"&basket_action=del&sid=118' width='1' height='1' alt=''>")};
this.reloadOrderForm=function(){if(this.objectForm.find(".section .invoice").length>0)window.location.reload(true)};function CheckText(obj,errorMessage,objName){if(obj.val()==""||obj.val()==errorMessage||obj.val()=="+7 (___) ___-__-__"){obj.val(errorMessage);obj.addClass("error");var data={requiredDataMissing:true,requiredDataType:objName};object.trigger(object.customEvents[500],[data]);return false}var data={requiredDataMissing:false,requiredDataType:objName};object.trigger(object.customEvents[500],
[data]);obj.removeClass("error");return true}function CheckEmail(obj){var value=obj.val();var indexOfDog=value.indexOf("@");var indexOfDot=value.indexOf(".");if(indexOfDog<=0||indexOfDot<1||indexOfDog==value.length-1||indexOfDot==value.length-1||indexOfDot==indexOfDog+1){obj.addClass("error");var data={requiredEmailMissing:true};object.trigger(object.customEvents[500],[data]);return false}var data={requiredEmailMissing:false};object.trigger(object.customEvents[500],[data]);obj.removeClass("error");
return true}function CheckDigits(obj,errorMessage,digitCount,objName){var value=obj.val();if(value!=errorMessage){value=value.replace(new RegExp("[^0-9]","g"),"");if(typeof digitCount!=="undefined"&&digitCount>0){if(value.length!=digitCount){obj.addClass("error");var data={requiredDataMissing:true,requiredDataType:objName};object.trigger(object.customEvents[500],[data]);if(value.length==0)obj.val(errorMessage);else obj.val(value);return false}}else if(value.length==0){var data={requiredDataMissing:true,
requiredDataType:objName};object.trigger(object.customEvents[500],[data]);obj.addClass("error");obj.val(errorMessage);return false}var data={requiredDataMissing:false,requiredDataType:objName};object.trigger(object.customEvents[500],[data]);obj.val(value);obj.removeClass("error");return true}return false}function CheckBonus(obj,errorMessage){var value=obj.val();value=value.replace(new RegExp("[^0-9]","g"),"");if(value.length==0)obj.val(0);else{var bonusCount={};$(this).trigger(object.customEvents[8],
[bonusCount]);bonusCount=bonusCount.data;var bonusCountCanPay={};$(this).trigger(object.customEvents[9],[bonusCountCanPay]);bonusCountCanPay=bonusCountCanPay.data;if(value>bonusCountCanPay)value=bonusCountCanPay;if(value>bonusCount)value=bonusCount;value=parseInt(value);obj.val(value);var data={bonusCountToPay:value};$(this).trigger(object.customEvents[3],[data])}}function SetUpCalendar(deliveryType){var calendarMaxDate={};calendarMaxDate=DateParseToObj(model.orderFormData.deliveryDateStr);calendarMaxDate.month-=
1;calendarMaxDate.day+=7;if(calendarMaxDate.month==1){if(calendarMaxDate.day>28){calendarMaxDate.day-=28;calendarMaxDate.month++}}else if(calendarMaxDate.day>31){calendarMaxDate.day-=31;calendarMaxDate.month++}if(calendarMaxDate.month>11){calendarMaxDate.month-=11;calendarMaxDate.year++}calendarMaxDate=new Date(calendarMaxDate.year,calendarMaxDate.month,calendarMaxDate.day);switch(model.orderFormData.deliveryType){case "delivery":var input=object.find("#DELIVERY_TYPE .page.one .calendar input");if(model.orderFormData.deliveryDateStrUser!=
0)input.datepicker("setDate",model.orderFormData.deliveryDateStrUser);else input.datepicker("setDate",model.orderFormData.deliveryDateStr);input.datepicker("option","minDate",model.orderFormData.deliveryDateStr);input.datepicker("option","maxDate",calendarMaxDate);break;case "pickup":var input=object.find("#DELIVERY_TYPE .page.two .calendar input");if(model.orderFormData.pickupDateStrUser!=0)input.datepicker("setDate",model.orderFormData.pickupDateStrUser);else input.datepicker("setDate",model.orderFormData.pickupDateStr);
input.datepicker("option","minDate",model.orderFormData.pickupDateStr);input.datepicker("option","maxDate",calendarMaxDate);break}}function HideOnlinePaymentError(){object.find("#PAYMENT_TYPE .titles .electromoney").show()}function SetBackgroundSize(){var background=object.find(".section .background");if(background.length>0){var sectionWidth=$(background[0]).parent().width();var viewportWidth=$(window).width();if(viewportWidth>sectionWidth){var offset=Math.floor((viewportWidth-sectionWidth)/2)*-1;
background.each(function(){$(this).css({"left":offset});$(this).css({"right":offset})})}}}function DateParseToObj(date){var obj=date.split(".");obj={day:parseInt(obj[0]),month:parseInt(obj[1]),year:parseInt(obj[2])};return obj}};MVC.Controller=function(model,view){InitOrderForm();view.objectForm.on(view.objectForm.customEvents[0],function(event,priceChange){if(typeof priceChange==="number")model.orderFormData.invoicePrice+=priceChange;view.setInvoiceTotalPrice();view.showCover();view.objectForm.trigger(view.objectForm.customEvents[1])});
view.objectForm.on(view.objectForm.customEvents[1],function(event,data){if(typeof data!=="undefined"){if(typeof data.deliveryType!=="undefined")model.orderFormData.deliveryType=data.deliveryType;if(typeof data.newDateStr!=="undefined"){var date=data.newDateStr;var dateParsed=DateParse(data.newDateStr);switch(model.orderFormData.deliveryType){case "delivery":model.orderFormData.deliveryDate=dateParsed;model.orderFormData.deliveryDateStrUser=date;break;case "pickup":model.orderFormData.pickupDate=dateParsed;
model.orderFormData.pickupDateStrUser=date;break}}view.objectForm.trigger(view.objectForm.customEvents[2],[data])}else view.objectForm.trigger(view.objectForm.customEvents[2])});view.objectForm.on(view.objectForm.customEvents[2],function(event,data){if(typeof data!=="undefined"){if(typeof data.paymentType!=="undefined")model.orderFormData.paymentType=data.paymentType;if(typeof data.personType!=="undefined")model.orderFormData.personType=data.personType;view.objectForm.trigger(view.objectForm.customEvents[4],
[data])}else view.objectForm.trigger(view.objectForm.customEvents[4])});view.objectForm.on(view.objectForm.customEvents[3],function(event,data){if(typeof data!=="undefined"){if(typeof data.bonusCountToPay!=="undefined")model.orderFormData.bonusCountToPay=data.bonusCountToPay;view.objectForm.trigger(view.objectForm.customEvents[4],[data])}else view.objectForm.trigger(view.objectForm.customEvents[4])});view.objectForm.on(view.objectForm.customEvents[4],function(event,data){if(typeof data!=="undefined")SetCartTotal(true,
data);else SetCartTotal(true)});view.objectForm.on(view.objectForm.customEvents[5],function(event,returnObj){returnObj.data=model.orderFormData.deliveryType});view.objectForm.on(view.objectForm.customEvents[6],function(event,returnObj){returnObj.data=model.orderFormData.paymentType});view.objectForm.on(view.objectForm.customEvents[7],function(event,returnObj){returnObj.data=model.orderFormData.invoicePrice});view.objectForm.on(view.objectForm.customEvents[8],function(event,returnObj){returnObj.data=
model.orderFormData.bonusCount});view.objectForm.on(view.objectForm.customEvents[9],function(event,returnObj){returnObj.data=model.orderFormData.bonusCountCanPay});view.objectForm.on(view.objectForm.customEvents[10],function(event,returnObj){returnObj.data=model.orderFormErrors});view.objectForm.on(view.objectForm.customEvents[13],function(event,returnObj){returnObj.data=model.orderFormData.personType});view.objectForm.on(view.objectForm.customEvents[11],function(event,callback){var result=SaveOrderForm();
if(typeof callback==="function")callback(result)});view.objectForm.on(view.objectForm.customEvents[12],function(event,data){if(typeof data!=="undefined")if(typeof data.partner!=="undefined")switch(data.partner){case "Ritorno":view.sendRitorno(data.product);break}});view.objectForm.on(view.objectForm.customEvents[500],function(event,data){if(typeof data!=="undefined"){if(typeof data.requiredDataMissing!=="undefined")if(data.requiredDataMissing==true){model.orderFormErrors.requiredDataMissing=data.requiredDataMissing;
model.orderFormErrors.requiredDataType.push(data.requiredDataType)}else if(data.requiredDataMissing==false){for(var i=0;i<model.orderFormErrors.requiredDataType.length;i++)if(model.orderFormErrors.requiredDataType[i]==data.requiredDataType)delete model.orderFormErrors.requiredDataType[i];model.orderFormErrors.requiredDataMissing=false;for(var i=0;i<model.orderFormErrors.requiredDataType.length;i++)if(typeof model.orderFormErrors.requiredDataType[i]!=="undefined")model.orderFormErrors.requiredDataMissing=
true}if(typeof data.requiredEmailMissing!=="undefined")model.orderFormErrors.requiredEmailMissing=data.requiredEmailMissing;if(typeof data.deliveryIDMissing!=="undefined"){model.orderFormErrors.deliveryIDMissing=data.deliveryIDMissing;if(model.orderFormErrors.deliveryIDMissing===true)if(model.orderFormData.deliveryType=="delivery")view.showDeliveryError();else if(model.orderFormData.deliveryType=="pickup")view.showPickupError()}if(typeof data.onlinePaymentNotAvailable!=="undefined"){model.orderFormErrors.onlinePaymentNotAvailable=
data.onlinePaymentNotAvailable;if(model.orderFormErrors.onlinePaymentNotAvailable===true)if(model.orderFormData.deliveryType=="pickup")if(model.orderFormData.paymentType=="electromoney")view.showPickupError();else view.showOnlinePaymentError(true)}if(typeof data.personFIDMissing!=="undefined"){model.orderFormErrors.personFIDMissing=data.personFIDMissing;if(model.orderFormErrors.personFIDMissing===true)view.showPaymentCashlessError()}}});function InitOrderForm(){model.orderFormData.invoicePrice=parseInt(view.objectForm.find("input[name='FINAL_BASKET_PRICE']").val());
if(isNaN(model.orderFormData.invoicePrice))model.orderFormData.invoicePrice=0;model.orderFormData.deliveryType=view.objectForm.find("input[name='DELIVERY_TYPE']").val();model.orderFormData.deliveryID=parseInt(view.objectForm.find("input[name='DELIVERY_ID']").val());if(isNaN(model.orderFormData.deliveryID))model.orderFormData.deliveryID=0;model.orderFormData.deliveryCityIsFree=view.objectForm.find("input[name='ORDER_FREE_DELIVERY_CITY']").val();model.orderFormData.deliveryDate=view.objectForm.find("input[name='ADDRESS_DELIVERY_DATE']").val();
model.orderFormData.deliveryDateStr=view.objectForm.find("input[name='ADDRESS_DELIVERY_DATE_STR']").val();model.orderFormData.pickupDate=model.orderFormData.deliveryDate;model.orderFormData.pickupDateStr=model.orderFormData.deliveryDateStr;if(typeof cityDeliveryRules!=="undefined")model.orderFormData.deliveryRules=cityDeliveryRules;model.orderFormData.paymentType=view.objectForm.find("input[name='PAYMENT_TYPE']").val();model.orderFormData.paymentElectroMoney=view.objectForm.find("input[name='ELECTRO_MONEY_TYPE']").val();
model.orderFormData.personType=parseInt(view.objectForm.find("input[name='PERSON_TYPE']").val());if(isNaN(model.orderFormData.personType))model.orderFormData.personType=0;model.orderFormData.personLocationID=parseInt(view.objectForm.find("input[name='LOCATION_ID']").val());if(isNaN(model.orderFormData.personLocationID))model.orderFormData.personLocationID=0;model.orderFormData.personFID=parseInt(view.objectForm.find("input[name='fid']").val());if(isNaN(model.orderFormData.personFID))model.orderFormData.personFID=
0;model.orderFormData.cartTotalNoDiscounts=parseInt(view.objectForm.find("input[name='FINAL_BASKET_PRICE_NO_DISCOUNTS']").val());if(isNaN(model.orderFormData.cartTotalNoDiscounts))model.orderFormData.cartTotalNoDiscounts=0;model.orderFormData.bonusCount=parseInt(view.objectForm.find("input[name='USER_BONUS_COUNT']").val());if(isNaN(model.orderFormData.bonusCount))model.orderFormData.bonusCount=0;model.orderFormData.bonusCountCanPay=parseInt(view.objectForm.find("input[name='CAN_PAY_BONUS_COUNT']").val());
if(isNaN(model.orderFormData.bonusCountCanPay))model.orderFormData.bonusCountCanPay=0;model.orderFormData.bonusCountToPay=parseInt(view.objectForm.find("input[name='BONUS_TO_PAY']").val());if(isNaN(model.orderFormData.bonusCountToPay))model.orderFormData.bonusCountToPay=0;if(model.orderFormData.bonusCountToPay>model.orderFormData.bonusCountCanPay)model.orderFormData.bonusCountToPay=model.orderFormData.bonusCountCanPay;if(model.orderFormData.bonusCountToPay>model.orderFormData.bonusCount)model.orderFormData.bonusCountToPay=
model.orderFormData.bonusCount;InitFromFields();for(var field in model.orderFormData)if(typeof model.orderFormData[field]==="undefined")model.orderFormData[field]=0;if(model.orderFormData.deliveryType=="delivery"&&view.objectForm.find("#delivery-delivery option").length==1)SetCartTotal(true);else if(model.orderFormData.deliveryType=="pickup"&&view.objectForm.find("#delivery-pickup option")==1)SetCartTotal(true);else SetCartTotal()}function InitFromFields(){if(model.orderFormData.deliveryType=="delivery"){model.orderFormData.deliveryPrice=
parseInt(view.objectForm.find("#delivery-delivery option:selected").attr("class"));if(isNaN(model.orderFormData.deliveryPrice))model.orderFormData.deliveryPrice=-1;if(model.orderFormData.deliveryID==0)model.orderFormData.deliveryID=parseInt(view.objectForm.find("#delivery-delivery option:selected").val())}else if(model.orderFormData.deliveryType=="pickup"){model.orderFormData.deliveryPrice=parseInt(view.objectForm.find("#delivery-pickup option:selected").attr("class"));if(isNaN(model.orderFormData.deliveryPrice))model.orderFormData.deliveryPrice=
0;model.orderFormData.deliveryID=parseInt(view.objectForm.find("#delivery-pickup option:selected").val())}}function SaveOrderForm(){view.objectForm.find("input[name='DELIVERY_TYPE']").val(model.orderFormData.deliveryType);view.objectForm.find("input[name='DELIVERY_ID']").val(model.orderFormData.deliveryID);view.objectForm.find("input[name='PAYMENT_TYPE']").val(model.orderFormData.paymentType);view.objectForm.find("input[name='ELECTRO_MONEY_TYPE']").val(model.orderFormData.paymentElectroMoney);view.objectForm.find("input[name='PERSON_TYPE']").val(model.orderFormData.personType);
view.objectForm.find("input[type='checkbox']").each(function(){var input=$(this);if(input.prop("checked")==true)input.val("on");else{input.prop("checked",true);input.val("off")}});return true}function SetCartTotal(isTotalPriceChanged,data){if(model.orderFormData.invoicePrice==0)view.reloadOrderForm();if(isTotalPriceChanged===true)if(model.orderFormData.deliveryType=="delivery"){var cityDeliveryRulesPrice=-2;var cityDeliveryRulesNeedToPay=0;var temp=CalculateCityDeliveryRules(model.orderFormData.invoicePrice);
cityDeliveryRulesPrice=temp[0];cityDeliveryRulesNeedToPay=temp[1];if(cityDeliveryRulesPrice>=0)model.orderFormData.deliveryPrice=cityDeliveryRulesPrice;else InitFromFields()}else if(model.orderFormData.deliveryType=="pickup")InitFromFields();model.orderFormData.cartTotal=model.orderFormData.invoicePrice+model.orderFormData.deliveryPrice-model.orderFormData.bonusCountToPay;if(model.orderFormData.deliveryPrice==-1)model.orderFormData.cartTotal++;if(typeof data!=="undefined")view.setOrderTotalPrice(true);
else view.setOrderTotalPrice();if(isTotalPriceChanged===true){if(model.orderFormData.deliveryType=="delivery"){view.showDeliveryNotice(cityDeliveryRulesPrice,cityDeliveryRulesNeedToPay);view.showDeliveryMessage()}else if(model.orderFormData.deliveryType=="pickup")view.showPickupMessage();if(model.orderFormData.paymentType=="cashless")if(typeof data!=="undefined")view.showPaymentCashless(data);else view.showPaymentCashless()}}function DateParse(newDate){var newDateStr="";newDate=newDate.split(".");
newDate={day:parseInt(newDate[0]),month:parseInt(newDate[1]),year:parseInt(newDate[2])};newDateStr+=newDate.day+" ";switch(newDate.month){case 1:newDateStr+="\u044f\u043d\u0432\u0430\u0440\u044f";break;case 2:newDateStr+="\u0444\u0435\u0432\u0440\u0430\u043b\u044f";break;case 3:newDateStr+="\u043c\u0430\u0440\u0442\u0430";break;case 4:newDateStr+="\u0430\u043f\u0440\u0435\u043b\u044f";break;case 5:newDateStr+="\u043c\u0430\u044f";break;case 6:newDateStr+="\u0438\u044e\u043d\u044f";break;case 7:newDateStr+=
"\u0438\u044e\u043b\u044f";break;case 8:newDateStr+="\u0430\u0432\u0433\u0443\u0441\u0442\u0430";break;case 9:newDateStr+="\u0441\u0435\u043d\u0442\u044f\u0431\u0440\u044f";break;case 10:newDateStr+="\u043e\u043a\u0442\u044f\u0431\u0440\u044f";break;case 11:newDateStr+="\u043d\u043e\u044f\u0431\u0440\u044f";break;case 12:newDateStr+="\u0434\u0435\u043a\u0430\u0431\u0440\u044f";break}return newDateStr}};var model=new MVC.Model;var view=new MVC.View(object);var controller=new MVC.Controller(model,view);
view.initPlugins()}})(jQuery)});function Range(element,minValue,maxValue){var form=element.parent().parent().parent();var dropDown=element.parent().parent();element.find("input").each(function(){var input=$(this);if(input.val()!=minValue&&input.val()!=maxValue)element.find("input").addClass("changed")});FilterSubmit(form,dropDown)}
function FilterSubmit(form,element,elementTop,inputTop){$(".drop-down").removeClass("filtered");var serialize="";form.find("input[type='hidden']").each(function(){var input=$(this);serialize+=encodeURIComponent(input.attr("name"))+"="+encodeURIComponent(input.val())+"&"});form.find("input:checked").each(function(){var input=$(this);serialize+=encodeURIComponent(input.attr("name"))+"="+encodeURIComponent(input.val())+"&"});form.find("input.changed").each(function(){var input=$(this);serialize+=encodeURIComponent(input.attr("name"))+
"="+encodeURIComponent(input.val())+"&"});var top="50%";if(systemParameters.mobileDevice.isCellPhone)top="100%";if(typeof elementTop!=="undefined"&&typeof inputTop!=="undefined")if(systemParameters.mobileDevice.isCellPhone)top=inputTop-elementTop+element.find("label.active").height();else top=inputTop-elementTop;var loaderHtml="<div class='fixed-wrap white'>&nbsp;</div>";loaderHtml+="<div class='show_filter_results_new'>";loaderHtml+="<div class='loader'>&nbsp;</div>";loaderHtml+="</div>";$(".show_filter_results_new").remove();
element.append(loaderHtml);$(".show_filter_results_new").css({"top":top});element.addClass("filtered");var timer=setTimeout(function(){$(".show_filter_results_new").remove();$(".fixed-wrap.white").remove();element.removeClass("filtered")},1E4);$.post("/ajax/filter.php",{action:"getCount",str:serialize},function(response){response=$.parseJSON(response);if(response.link.length>0){$(".show_filter_results_new").remove();$(".fixed-wrap.white").remove();element.append(response.link);$(".show_filter_results_new").css({"top":top});
clearTimeout(timer)}})}
function WindowOnResize(){if(typeof jQuery!=="undefined"&&jQuery.isFunction($(window).width)){var globalViewportWidth=$(window).width();systemParameters.mobileDevice.isCellPhone=false;systemParameters.mobileDevice.isTabletPC=false;systemParameters.mobileDevice.isPC=false;if(globalViewportWidth>0&&globalViewportWidth<570)systemParameters.mobileDevice.isCellPhone=true;else if(globalViewportWidth<=959)systemParameters.mobileDevice.isTabletPC=true;else systemParameters.mobileDevice.isPC=true}if($(".header .column.left .catalog").hasClass("index-page"))if(systemParameters.mobileDevice.isPC)$(".category.box .content .column.left .catalog .content").show();
else if(systemParameters.mobileDevice.isTabletPC)$(".category.box .content .column.left .catalog .content").hide()}
function WordDeclension(count,words){if(typeof words==="object"&&words.length>=3){var residue=count%100;if(residue<20)if(residue<10)switch(residue%10){case 0:return words[2];case 1:return words[0];case 2:case 3:case 4:return words[1];case 5:case 6:case 7:case 8:case 9:return words[2];default:return words[0]}else return words[2];else switch(residue%10){case 0:return words[2];case 1:return words[0];case 2:case 3:case 4:return words[1];case 5:case 6:case 7:case 8:case 9:return words[2];default:return words[0]}}}
;